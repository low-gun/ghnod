(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8587],{7614:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/mypage",function(){return n(2754)}])},7081:function(e,t,n){"use strict";n.d(t,{Z:function(){return SearchFilter}});var r=n(5893),i=n(1988);function SearchFilter(e){let{searchType:t,setSearchType:n,searchQuery:o,setSearchQuery:l,searchOptions:s=[],onSearchUpdate:a,startDate:d,endDate:c,setStartDate:p,setEndDate:u}=e,x=s.find(e=>e.value===t),h={padding:"8px",fontSize:"14px",borderRadius:"6px",border:"1px solid #ccc"},handleQueryChange=e=>{let n=e.target.value;l(n),a(t,n)};return(0,r.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[(0,r.jsx)("select",{value:t,onChange:e=>{let t=e.target.value;n(t),l(""),a(t,"")},style:{...h,width:"140px"},children:s.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))}),(null==x?void 0:x.type)==="date"?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.ZP,{selected:d,onChange:e=>p(e),placeholderText:"시작 날짜",dateFormat:"yyyy-MM-dd",customInput:(0,r.jsx)("input",{style:{...h,width:"140px",height:"38px"}})}),(0,r.jsx)(i.ZP,{selected:c,onChange:e=>u(e),placeholderText:"종료 날짜",dateFormat:"yyyy-MM-dd",customInput:(0,r.jsx)("input",{style:{...h,width:"140px",height:"38px"}})})]}):(null==x?void 0:x.type)==="select"&&Array.isArray(x.options)?(0,r.jsxs)("select",{value:o,onChange:handleQueryChange,style:{...h,width:"180px"},children:[(0,r.jsx)("option",{value:"",children:"전체"}),x.options.map(e=>(0,r.jsx)("option",{value:e.value,children:e.label},e.value))]}):(0,r.jsx)("input",{type:"text",placeholder:"검색어 입력",value:o,onChange:handleQueryChange,style:{...h,width:"240px"}})]})}n(5890)},3803:function(e,t,n){"use strict";n.d(t,{Z:function(){return ChangePasswordModal}});var r=n(5893),i=n(7294),o=n(3504),l=n(1163),s=n(7771);function ChangePasswordModal(e){let{onClose:t,userId:n,isForcedReset:y=!1}=e,g=(0,l.useRouter)(),[m,j]=(0,i.useState)(""),[b,v]=(0,i.useState)(""),[w,S]=(0,i.useState)(""),[k,C]=(0,i.useState)(""),[_,D]=(0,i.useState)(!1),[z,R]=(0,i.useState)(!1),[I,P]=(0,i.useState)(!1),handleChangePassword=async()=>{if(!b||!w||!y&&!m){C("모든 항목을 입력해주세요.");return}if(b!==w){C("새 비밀번호가 일치하지 않습니다.");return}try{let e=y?{newPassword:b,userId:n}:{currentPassword:m,newPassword:b};await o.ZP.post("/mypage/change-password",e),alert("비밀번호가 변경되었습니다. 다시 로그인해주세요."),t(),g.replace("/login")}catch(t){var e,r;console.error("❌ 비밀번호 변경 실패:",t),C((null===(r=t.response)||void 0===r?void 0:null===(e=r.data)||void 0===e?void 0:e.message)||"비밀번호 변경 중 오류가 발생했습니다.")}},renderPasswordInput=(e,t,n,i,o)=>(0,r.jsxs)("div",{style:c,children:[(0,r.jsx)("label",{children:e}),(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsx)("input",{type:i?"text":"password",value:t,onChange:e=>n(e.target.value),style:{...p,paddingRight:"36px"}}),(0,r.jsx)("span",{onClick:()=>o(!i),style:u,children:i?(0,r.jsx)(s.p3W,{}):(0,r.jsx)(s.w8I,{})})]})]});return(0,r.jsx)("div",{style:a,children:(0,r.jsxs)("div",{style:d,children:[(0,r.jsx)("h3",{style:{marginBottom:"16px"},children:y?"비밀번호 재설정":"비밀번호 변경"}),!y&&renderPasswordInput("현재 비밀번호",m,j,_,D),renderPasswordInput("새 비밀번호",b,v,z,R),renderPasswordInput("새 비밀번호 확인",w,S,I,P),k&&(0,r.jsx)("p",{style:x,children:k}),(0,r.jsxs)("div",{style:{marginTop:"20px",textAlign:"right"},children:[(0,r.jsx)("button",{onClick:handleChangePassword,style:h,children:"변경하기"}),(0,r.jsx)("button",{onClick:t,style:f,children:"취소"})]})]})})}let a={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},d={backgroundColor:"#fff",padding:"24px",borderRadius:"8px",width:"360px",boxShadow:"0 4px 12px rgba(0,0,0,0.2)"},c={marginBottom:"12px",display:"flex",flexDirection:"column",gap:"6px"},p={padding:"8px",fontSize:"0.95rem",border:"1px solid #ccc",borderRadius:"4px",width:"100%"},u={position:"absolute",top:"50%",right:"10px",transform:"translateY(-50%)",cursor:"pointer",fontSize:"18px",color:"#888"},x={color:"red",fontSize:"0.85rem",marginTop:"6px"},h={padding:"8px 16px",marginRight:"8px",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},f={...h,backgroundColor:"#ccc",color:"#333"}},2754:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return MyPage}});var r=n(5893),i=n(7294),o=n(1163),l=n(3504),s=n(7066);let a=["내 정보","수강정보","결제내역","쿠폰","포인트","1:1문의"];function MyPageSidebar(e){let{activeMenu:t,setActiveMenu:n}=e,l=(0,o.useRouter)(),[s,d]=(0,i.useState)(null);if((0,i.useEffect)(()=>{let handleResize=()=>d(window.innerWidth);return handleResize(),window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[]),null===s)return null;let c=s<=768,p=s<=1120?"14px":"15px",u=s<=1120?"16px":"20px";return(0,r.jsx)("div",{style:{position:"sticky",top:"80px",alignSelf:"stretch",background:"#f5f5f5",borderRight:"1px solid #ddd",padding:"20px 0",transition:"width 0.3s ease",width:s<=1280?"50px":"150px",height:"calc(100vh - 80px)",zIndex:10},children:(0,r.jsx)("ul",{style:{listStyle:"none",padding:0,margin:0},children:a.map(e=>(0,r.jsx)("li",{onClick:()=>{n(e),l.push({pathname:"/mypage",query:{menu:e}})},style:{padding:"10px ".concat(u),marginBottom:"5px",cursor:"pointer",background:e===t?"#e0e0e0":"transparent",borderRadius:"4px",fontWeight:e===t?"bold":"normal",fontSize:p,writingMode:c?"vertical-lr":"horizontal-tb",textAlign:c?"center":"left"},children:e},e))})})}var d=n(2378);n(5890);var c=n(7081);function ReviewModal(e){let{visible:t,onClose:n,productId:o,reviewId:s,initialData:a,onSuccess:d}=e,[c,j]=(0,i.useState)(0),[b,v]=(0,i.useState)(""),[w,S]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{t&&(j((null==a?void 0:a.rating)||0),v((null==a?void 0:a.comment)||""))},[t,a]),(0,i.useEffect)(()=>{let handleKeyDown=e=>{"Escape"===e.key&&n()};return window.addEventListener("keydown",handleKeyDown),()=>window.removeEventListener("keydown",handleKeyDown)},[n]),!t)return null;let handleSubmit=async()=>{if(!b.trim())return alert("내용을 입력해주세요.");try{S(!0),s?await l.ZP.put("/products/".concat(o,"/reviews/").concat(s),{rating:c,comment:b}):await l.ZP.post("/products/".concat(o,"/reviews"),{rating:c,comment:b}),alert("후기가 ".concat(s?"수정":"등록","되었습니다!")),null==d||d(),n()}catch(e){console.error("후기 작성 실패:",e),alert("후기 작성에 실패했습니다.")}finally{S(!1)}},handleDelete=async()=>{if(s&&window.confirm("후기를 삭제하시겠습니까?"))try{S(!0),await l.ZP.delete("/products/".concat(o,"/reviews/").concat(s)),alert("후기가 삭제되었습니다."),null==d||d(),n()}catch(e){console.error("❌ 후기 삭제 실패:",e),alert("후기 삭제에 실패했습니다.")}finally{S(!1)}};return(0,r.jsx)("div",{style:p,children:(0,r.jsxs)("div",{style:u,children:[(0,r.jsx)("button",{onClick:n,style:h,children:"\xd7"}),(null==a?void 0:a.thumbnail)&&(0,r.jsx)("img",{src:a.thumbnail,alt:"강의 썸네일",style:x}),(null==a?void 0:a.title)&&(0,r.jsx)("div",{style:f,children:a.title}),(0,r.jsx)("div",{style:{marginBottom:16},children:[1,2,3,4,5].map(e=>(0,r.jsx)("span",{onClick:()=>j(e),style:{fontSize:"20px",cursor:"pointer",color:e<=c?"#facc15":"#ccc",marginRight:4},children:"★"},e))}),(0,r.jsx)("div",{style:{marginBottom:8},children:(0,r.jsx)("textarea",{value:b,onChange:e=>v(e.target.value),rows:4,style:{...g,width:"100%",resize:"none"},placeholder:"수강후기를 작성해주세요."})}),(null==a?void 0:a.created_at)&&(0,r.jsxs)("div",{style:y,children:["작성일시: ",new Date(a.created_at).toLocaleString("ko-KR")]}),(null==a?void 0:a.updated_at)&&a.updated_at!==a.created_at&&(0,r.jsxs)("div",{style:y,children:["수정일시:"," ",new Date(a.updated_at).toLocaleString("ko-KR")]}),(0,r.jsxs)("div",{style:m,children:[s&&(0,r.jsx)("button",{onClick:handleDelete,disabled:w,style:buttonStyle("#ccc","#333"),children:"삭제"}),(0,r.jsx)("button",{onClick:handleSubmit,disabled:w,style:buttonStyle("#0070f3","#fff"),children:s?"수정":"등록"})]})]})})}let p={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:9999},u={position:"relative",backgroundColor:"#fff",borderRadius:"8px",padding:"24px",width:"400px",boxShadow:"0 4px 20px rgba(0,0,0,0.2)"},x={width:"100%",height:"160px",objectFit:"cover",borderRadius:"8px",marginBottom:"12px"},h={position:"absolute",top:"12px",right:"12px",background:"transparent",border:"none",fontSize:"20px",cursor:"pointer"},f={marginBottom:12,fontWeight:"bold",fontSize:"16px"},y={fontSize:"12px",color:"#888",marginBottom:4},g={padding:"8px",borderRadius:"4px",border:"1px solid #ccc",fontSize:"14px"},buttonStyle=(e,t)=>({padding:"8px 14px",backgroundColor:e,color:t,border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer"}),m={display:"flex",justifyContent:"flex-end",gap:8};function formatKoreanDate(e){if(!e)return"";let t=new Date(e);return isNaN(t.getTime())?e:"".concat(t.getFullYear(),". ").concat(t.getMonth()+1,". ").concat(t.getDate(),".")}function MyCourse(){let e=(0,o.useRouter)(),[t,n]=(0,i.useState)("title"),[s,a]=(0,i.useState)(""),[p,u]=(0,i.useState)([null,null]),[x,h]=(0,i.useState)({key:"",direction:""}),[f,y]=(0,i.useState)([]),[g,m]=(0,i.useState)(!1),[R,I]=(0,i.useState)(1),P=(0,d.H_)(),[E,T]=(0,i.useState)(!1),[O,B]=(0,i.useState)(null);(0,i.useEffect)(()=>{let handleResize=()=>B(window.innerWidth);return handleResize(),window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[]),(0,i.useEffect)(()=>{let check=()=>{let e=window.innerWidth;T(P&&e>500&&e<1024)};return check(),window.addEventListener("resize",check),()=>window.removeEventListener("resize",check)},[P]);let[M,W]=(0,i.useState)(!1),[L,F]=(0,i.useState)(null),handleOpenReviewModal=e=>{F(e),W(!0)};(0,i.useEffect)(()=>{let fetchData=async()=>{try{m(!0);let e=await l.ZP.get("/mypage/courses",{params:{all:!0}});e.data.success&&y(e.data.courses)}catch(e){console.error("❌ 수강 데이터 불러오기 실패",e)}finally{m(!1)}};fetchData()},[]);let N=(0,i.useMemo)(()=>{let e=s.toLowerCase(),n=f.filter(n=>{let r=n[t];if(r&&"string"==typeof r&&!r.toLowerCase().includes(e))return!1;if("date"===t&&(p[0]||p[1])){let e=new Date(n.start_date);if(p[0]&&e<p[0]||p[1]&&e>p[1])return!1}return!0});return console.log("✅ filteredCourses.length:",n.length),n},[f,t,s,p]),A=(0,i.useMemo)(()=>{let e=[...N];return x.key&&e.sort((e,t)=>{let n=e[x.key],r=t[x.key];return"start_date"===x.key?"asc"===x.direction?new Date(n)-new Date(r):new Date(r)-new Date(n):"string"==typeof n?"asc"===x.direction?n.localeCompare(r):r.localeCompare(n):0}),e},[f,x]),handleSort=e=>{let t=x.key===e&&"asc"===x.direction?"desc":"asc";h({key:e,direction:t})},K=(0,i.useMemo)(()=>{let e=(R-1)*10,t=e+10;return A.slice(e,t)},[A,R,10]),handleDownloadCertificate=async e=>{try{let t=await l.ZP.get("/user/certificates/".concat(e.certificate_id,"/download"),{responseType:"blob"}),n=window.URL.createObjectURL(new Blob([t.data])),r=document.createElement("a");r.href=n,r.setAttribute("download","".concat(e.title,"_수료증.pdf")),document.body.appendChild(r),r.click(),r.remove()}catch(e){console.error("❌ 수료증 다운로드 실패:",e),alert("수료증 다운로드 중 오류가 발생했습니다.")}},q=Math.ceil(N.length/10),renderStatusBadge=e=>(0,r.jsx)("span",{style:{backgroundColor:{예정:"#0070f3",진행중:"#f59e0b",완료:"#10b981"}[e]||"#ccc",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px"},children:e});return(0,r.jsxs)("div",{style:{padding:P?0:20,marginTop:E?"16px":0},children:[!(O&&O<=480)&&(0,r.jsx)("h2",{style:_,children:"수강정보"}),!P&&(0,r.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"16px"},children:[(0,r.jsx)(c.Z,{searchType:t,setSearchType:n,searchQuery:s,setSearchQuery:a,startDate:p[0],endDate:p[1],setStartDate:e=>u([e,p[1]]),setEndDate:e=>u([p[0],e]),searchOptions:[{value:"title",label:"강의명",type:"text"},{value:"location",label:"장소",type:"text"},{value:"instructor",label:"강사",type:"text"},{value:"status",label:"상태",type:"select",options:[{value:"예정",label:"예정"},{value:"진행중",label:"진행중"},{value:"완료",label:"완료"}]},{value:"date",label:"일정",type:"date"}],onSearchUpdate:(e,t)=>{n(e),a(t),I(1)}}),(0,r.jsx)("button",{onClick:()=>{n("title"),a(""),u([null,null]),h({key:"",direction:""}),I(1)},style:MyCourse_buttonStyle("#ccc","#333"),children:"초기화"})]}),P?(0,r.jsx)("div",{style:{display:"grid",gap:"16px",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))"},children:K.map(e=>(0,r.jsxs)("div",{style:D,children:[(0,r.jsxs)("div",{style:z,children:[(0,r.jsx)("strong",{children:"강의명"})," ",e.title]}),(0,r.jsxs)("div",{style:z,children:[(0,r.jsx)("strong",{children:"일정"})," ",new Date(e.start_date).toISOString().slice(0,10)===new Date(e.end_date).toISOString().slice(0,10)?formatKoreanDate(e.start_date):"".concat(formatKoreanDate(e.start_date)," ~ ").concat(formatKoreanDate(e.end_date))]}),(0,r.jsxs)("div",{style:z,children:[(0,r.jsx)("strong",{children:"장소"})," ",e.location]}),(0,r.jsxs)("div",{style:z,children:[(0,r.jsx)("strong",{children:"강사"})," ",e.instructor]}),(0,r.jsxs)("div",{style:z,children:[(0,r.jsx)("strong",{children:"상태"})," ",renderStatusBadge(e.status)]}),e.certificate_id&&(0,r.jsxs)("div",{style:z,children:[(0,r.jsx)("strong",{children:"수료증"}),(0,r.jsx)("button",{style:S,onClick:()=>handleDownloadCertificate(e),children:"다운로드"})]}),(0,r.jsxs)("div",{style:z,children:[(0,r.jsx)("strong",{children:"후기"})," ","완료"===e.status?(0,r.jsx)("button",{style:C,onClick:()=>handleOpenReviewModal({...e}),children:e.is_reviewed?"수정":"작성"}):"-"]})]},e.order_item_id))}):(0,r.jsx)("div",{style:{overflowX:"auto"},children:(0,r.jsxs)("table",{style:{width:"100%",fontSize:"15px",borderCollapse:"collapse"},children:[(0,r.jsx)("thead",{style:{background:"#f9f9f9"},children:(0,r.jsx)("tr",{children:["No","title","date","location","instructor","status","certificate","review"].map(e=>{let t="No"===e?null:"date"===e?"start_date":e,n=!["No","certificate"].includes(e),i=x.key===t;return(0,r.jsxs)("th",{onClick:()=>{n&&handleSort(t)},style:b,children:[j[e]," ",n&&(0,r.jsx)("span",{style:{...w,color:i?"#000":"#ccc"},children:i?"asc"===x.direction?"▲":"▼":"↕"})]},e)})})}),(0,r.jsx)("tbody",{children:0===N.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:8,style:v,children:"수강 내역이 없습니다."})}):K.map((t,n)=>(0,r.jsxs)("tr",{style:{backgroundColor:n%2==0?"#fff":"#fafafa"},children:[(0,r.jsx)("td",{style:v,children:(R-1)*10+n+1}),(0,r.jsxs)("td",{style:{...v,cursor:"pointer",color:"#0070f3"},onClick:()=>e.push("/education/".concat(t.type,"/").concat(t.schedule_id)),children:[t.title,t.category?" (".concat(t.category,")"):""]}),(0,r.jsx)("td",{style:v,children:new Date(t.start_date).toISOString().slice(0,10)===new Date(t.end_date).toISOString().slice(0,10)?formatKoreanDate(t.start_date):(0,r.jsxs)(r.Fragment,{children:[formatKoreanDate(t.start_date)," ",(0,r.jsx)("br",{}),"~"," ",formatKoreanDate(t.end_date)]})}),(0,r.jsx)("td",{style:v,children:t.location}),(0,r.jsx)("td",{style:v,children:t.instructor}),(0,r.jsx)("td",{style:v,children:renderStatusBadge(t.status)}),(0,r.jsx)("td",{style:v,children:t.certificate_id?(0,r.jsx)("button",{style:{...S,backgroundColor:"#0070f3",color:"#fff",border:"none",cursor:"pointer"},onClick:()=>handleDownloadCertificate(t),children:"다운로드"}):"-"}),(0,r.jsx)("td",{style:v,children:"완료"===t.status?(0,r.jsx)("button",{style:{...C,backgroundColor:t.is_reviewed?"#999":"#0070f3"},onClick:()=>handleOpenReviewModal({...t,reviewId:t.review_id,initialData:{rating:t.review_rating,comment:t.review_comment,title:t.title,created_at:t.review_created_at,updated_at:t.review_updated_at}}),children:t.is_reviewed?"수정":"작성"}):"-"})]},t.order_item_id))})]})}),(0,r.jsx)("div",{style:{marginTop:"20px",textAlign:"center"},children:q>0?Array.from({length:q},(e,t)=>t+1).map(e=>(0,r.jsx)("button",{onClick:()=>I(e),style:{...k,fontWeight:R===e?"bold":"normal",backgroundColor:R===e?"#eee":"#fff"},children:e},e)):(0,r.jsx)("span",{style:{color:"#888",fontSize:"14px"},children:"1페이지"})}),(0,r.jsx)(ReviewModal,{visible:M,onClose:()=>{W(!1),F(null)},productId:null==L?void 0:L.product_id,scheduleId:null==L?void 0:L.schedule_id,reviewId:null==L?void 0:L.reviewId,initialData:null==L?void 0:L.initialData,onSuccess:()=>e.replace(e.asPath)})]})}let j={No:"No",title:"강의",date:"일정",location:"장소",instructor:"강사",status:"상태",certificate:"수료증",review:"후기"},MyCourse_buttonStyle=(e,t)=>({padding:"8px 14px",backgroundColor:e,color:t,border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer"}),b={padding:"10px",textAlign:"center",fontWeight:"bold",cursor:"pointer",height:"60px",verticalAlign:"middle"},v={padding:"12px",textAlign:"center",height:"60px",verticalAlign:"middle"},w={fontSize:"11px",marginLeft:"4px",verticalAlign:"middle"},S={padding:"4px 8px",fontSize:"12px",borderRadius:"4px",border:"1px solid #aaa",backgroundColor:"#eee",color:"#666",cursor:"not-allowed"},k={padding:"6px 10px",fontSize:"14px",border:"1px solid #ccc",borderRadius:"4px",margin:"0 4px",cursor:"pointer"},C={padding:"6px 12px",fontSize:"13px",borderRadius:"6px",border:"none",backgroundColor:"#0070f3",color:"#fff",fontWeight:"bold",cursor:"pointer",transition:"all 0.2s"},_={fontSize:"1.4rem",fontWeight:"bold",marginBottom:"20px"},D={padding:"16px",border:"1px solid #ddd",borderRadius:"8px",background:"#fff",boxShadow:"0 1px 4px rgba(0,0,0,0.05)"},z={marginBottom:"8px",fontSize:"14px",display:"flex",justifyContent:"space-between",gap:"8px"};var R=n(3803);function MyInfo(e){let{data:t}=e;if(!t||0===t.length)return(0,r.jsx)(r.Fragment,{});let{name:n,email:o,phone:s,company:a="",department:c="",position:p="",marketing_agree:u=0}=t[0],[x,h]=(0,i.useState)(n),[f,y]=(0,i.useState)(s),[g,m]=(0,i.useState)(a),[j,b]=(0,i.useState)(c),[v,w]=(0,i.useState)(p),[S,k]=(0,i.useState)(1===u),[C,_]=(0,i.useState)(!1),[D,z]=(0,i.useState)(!1),[M,L]=(0,i.useState)(!1),F=(0,d.dD)(),N={flex:1,padding:"12px 0",fontSize:"1rem",backgroundColor:"#0070f3",color:"#fff",border:"none",borderRadius:"6px",cursor:"pointer",maxWidth:"160px"},A={...N,backgroundColor:"#2196F3"},K={...N,backgroundColor:"#ccc",color:"#333"},q={backgroundColor:"#fff",borderRadius:"12px",padding:F?"16px":"24px",boxShadow:F?"none":"0 2px 10px rgba(0,0,0,0.06)",maxWidth:"900px",position:"relative",marginBottom:F?"16px":"24px"},Z={display:"grid",gridTemplateColumns:F?"1fr":"1fr 1fr",rowGap:"16px",columnGap:F?"0px":"32px"},handleSave=async()=>{try{L(!0),await l.ZP.patch("/mypage/info",{username:x,phone:f,company:g,department:j,position:v,marketing_agree:S?1:0}),alert("정보가 수정되었습니다."),_(!1)}catch(e){console.error("❌ 수정 실패",e),alert("정보 수정에 실패했습니다.")}finally{L(!1)}},handleWithdraw=async()=>{let e=window.confirm("정말 탈퇴하시겠습니까? 탈퇴 후에는 복구할 수 없습니다.");if(e)try{await l.ZP.delete("/mypage/delete-account"),localStorage.removeItem("token"),sessionStorage.removeItem("token"),alert("탈퇴가 완료되었습니다. 메인 페이지로 이동합니다."),window.location.href="/"}catch(e){console.error("❌ 탈퇴 실패:",e),alert("탈퇴 처리 중 오류가 발생했습니다.")}};return(0,r.jsxs)("div",{style:{padding:F?0:20},children:[!F&&(0,r.jsx)("h2",{style:I,children:"내 정보"}),(0,r.jsxs)("div",{style:q,children:[!F&&(0,r.jsx)("h3",{style:P,children:"기본정보"}),(0,r.jsx)("button",{onClick:handleWithdraw,style:E,children:"✖"}),(0,r.jsxs)("div",{style:Z,children:[(0,r.jsx)(InfoField,{label:"이름",value:x,editing:C,onChange:h}),(0,r.jsx)(InfoField,{label:"연락처",value:f,editing:C,onChange:y}),(0,r.jsxs)("div",{style:T,children:[(0,r.jsx)("span",{style:O,children:"이메일"}),(0,r.jsx)("span",{style:B,children:o})]}),(0,r.jsxs)("div",{style:T,children:[(0,r.jsx)("span",{style:O,children:"비밀번호"}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"25px"},children:[(0,r.jsx)("span",{style:B,children:"********"}),(0,r.jsx)("button",{style:W,onClick:()=>z(!0),children:"변경"})]})]})]})]}),(0,r.jsxs)("div",{style:{...q,marginTop:F?"16px":"24px"},children:[!F&&(0,r.jsx)("h3",{style:P,children:"추가정보"}),(0,r.jsxs)("div",{style:{...Z,marginTop:F?"0":"8px"},children:[(0,r.jsx)(InfoField,{label:"소속",value:g,editing:C,onChange:m}),(0,r.jsx)(InfoField,{label:"부서",value:j,editing:C,onChange:b}),(0,r.jsx)(InfoField,{label:"직책",value:v,editing:C,onChange:w}),(0,r.jsxs)("div",{style:T,children:[(0,r.jsx)("span",{style:O,children:"마케팅 수신 동의"}),C?(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{style:{marginRight:"12px"},children:[(0,r.jsx)("input",{type:"radio",value:"1",checked:S,onChange:()=>k(!0)})," ","동의함"]}),(0,r.jsxs)("label",{children:[(0,r.jsx)("input",{type:"radio",value:"0",checked:!S,onChange:()=>k(!1)})," ","동의 안 함"]})]}):(0,r.jsx)("span",{style:B,children:S?"동의함":"동의 안 함"})]})]})]}),(0,r.jsx)("div",{style:{marginTop:"24px",display:"flex",justifyContent:"center",gap:"12px"},children:C?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:handleSave,style:A,disabled:M,children:M?"저장 중...":"저장"}),(0,r.jsx)("button",{onClick:()=>_(!1),style:K,children:"취소"})]}):(0,r.jsx)("button",{onClick:()=>_(!0),style:N,children:"수정하기"})}),D&&(0,r.jsx)(R.Z,{onClose:()=>z(!1)})]})}function InfoField(e){let{label:t,value:n,editing:i,onChange:o}=e;return(0,r.jsxs)("div",{style:T,children:[(0,r.jsx)("span",{style:O,children:t}),i?(0,r.jsx)("input",{value:n,onChange:e=>o(e.target.value),style:M}):(0,r.jsx)("span",{style:B,children:n||"-"})]})}let I={fontSize:"1.4rem",fontWeight:"bold",marginBottom:"20px"},P={fontSize:"1.1rem",fontWeight:"bold",marginBottom:"16px"},E={position:"absolute",top:"16px",right:"16px",background:"transparent",border:"none",fontSize:"1rem",color:"#888",cursor:"pointer"},T={display:"flex",flexDirection:"column"},O={fontSize:"0.85rem",color:"#888",marginBottom:"4px"},B={fontSize:"1rem",color:"#222",fontWeight:"500"},M={padding:"6px",fontSize:"0.95rem",borderRadius:"4px",border:"1px solid #ccc"},W={fontSize:"0.75rem",padding:"4px 8px",borderRadius:"4px",backgroundColor:"#ddd",border:"none",cursor:"pointer"};var L=n(1988),F=n(7104);function formatKoreanDateTime(e){if(!e)return"";let t=new Date(e);return isNaN(t)?e:t.toLocaleString("ko-KR",{dateStyle:"medium",timeStyle:"short"})}function getStatusLabel(e){return"결제완료"===e||"paid"===e?"완료":"결제실패"===e||"failed"===e?"실패":"환불완료"===e||"refunded"===e?"환불":e||"미확인"}function PaymentHistory(e){let{data:t}=e;console.log("\uD83E\uDDFE PaymentHistory data:",t);let n=(0,o.useRouter)(),[l,s]=(0,i.useState)("order_id"),[a,c]=(0,i.useState)(""),[p,u]=(0,i.useState)([null,null]),[x,h]=(0,i.useState)({key:null,direction:"asc"}),[f,y]=(0,i.useState)(1),g=(0,d.H_)(),[m,j]=(0,i.useState)(!1),[b,v]=(0,i.useState)(null);(0,i.useEffect)(()=>{let handleResize=()=>v(window.innerWidth);return handleResize(),window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[]),(0,i.useEffect)(()=>{let check=()=>{let e=window.innerWidth;j(g&&e>500&&e<1024)};return check(),window.addEventListener("resize",check),()=>window.removeEventListener("resize",check)},[g]),(0,i.useEffect)(()=>{h({key:"null",direction:"asc"})},[]);let handleSort=e=>{h(t=>({key:e,direction:t.key===e&&"asc"===t.direction?"desc":"asc"}))},renderStatusBadge=e=>(0,r.jsx)("span",{style:{backgroundColor:{완료:"#3b82f6",실패:"#ef4444",환불:"#6b7280"}[e]||"#ccc",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px"},children:e}),w=Array.from(new Set(t.map(e=>e.payment_method).filter(Boolean)));Array.from(new Set(t.map(e=>e.status).filter(Boolean)));let S=(0,i.useMemo)(()=>{let e=[...t];if("order_id"===l&&a&&(e=e.filter(e=>String(e.order_id).includes(a))),"status"===l&&a&&(e=e.filter(e=>{let t=getStatusLabel(e.status);return t===a})),"payment_method"===l&&a&&(e=e.filter(e=>e.payment_method===a)),"amount"===l&&a&&(e=e.filter(e=>String(e.amount).includes(a))),"date"===l){let[t,n]=p;t&&n&&(e=e.filter(e=>{let r=new Date(e.created_at);return r>=t&&r<=n}))}return x.key&&e.sort((e,t)=>{if("discount_total"===x.key){let n=(e.used_point||0)+(e.coupon_discount||0),r=(t.used_point||0)+(t.coupon_discount||0);return"asc"===x.direction?n-r:r-n}let n=e[x.key],r=t[x.key];return"created_at"===x.key?"asc"===x.direction?new Date(n)-new Date(r):new Date(r)-new Date(n):"number"==typeof n?"asc"===x.direction?n-r:r-n:0}),e},[t,l,a,p,x]),k=Math.ceil(S.length/10),C=S.slice((f-1)*10,10*f);return(0,r.jsxs)("div",{style:{padding:g?0:20,marginTop:m?"16px":0},children:[!(b&&b<=480)&&(0,r.jsx)("h2",{style:H,children:"결제내역"}),!g&&(0,r.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"16px"},children:[(0,r.jsxs)("select",{value:l,onChange:e=>{s(e.target.value),c(""),u([null,null])},style:N,children:[(0,r.jsx)("option",{value:"order_id",children:"주문번호"}),(0,r.jsx)("option",{value:"date",children:"결제일"}),(0,r.jsx)("option",{value:"amount",children:"금액"}),(0,r.jsx)("option",{value:"payment_method",children:"결제수단"}),(0,r.jsx)("option",{value:"status",children:"상태"})]}),"date"===l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L.ZP,{selected:p[0],onChange:e=>u([e,p[1]]),placeholderText:"시작일",dateFormat:"yyyy-MM-dd",customInput:(0,r.jsx)("input",{style:N})}),(0,r.jsx)(L.ZP,{selected:p[1],onChange:e=>u([p[0],e]),placeholderText:"종료일",dateFormat:"yyyy-MM-dd",customInput:(0,r.jsx)("input",{style:N})})]}),["amount","order_id"].includes(l)&&(0,r.jsx)("input",{type:"text",placeholder:"amount"===l?"금액 입력":"주문번호 입력",value:a,onChange:e=>c(e.target.value),style:N}),"payment_method"===l&&(0,r.jsxs)("select",{value:a,onChange:e=>c(e.target.value),style:N,children:[(0,r.jsx)("option",{value:"",children:"전체"}),w.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),"status"===l&&(0,r.jsxs)("select",{value:a,onChange:e=>c(e.target.value),style:N,children:[(0,r.jsx)("option",{value:"",children:"전체"}),["paid","failed","refunded"].map(e=>{let t=getStatusLabel(e);return(0,r.jsx)("option",{value:t,children:t},e)})]})]}),g?(0,r.jsx)("div",{style:{display:"grid",gap:"16px",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))"},children:C.map((e,t)=>(0,r.jsxs)("div",{style:G,children:[(0,r.jsxs)("div",{style:Q,children:[(0,r.jsx)("strong",{children:"주문번호"}),(0,r.jsx)("span",{style:{color:"#0070f3",cursor:"pointer"},onClick:()=>n.push("/orders/".concat(e.order_id)),children:e.order_id})]}),(0,r.jsxs)("div",{style:Q,children:[(0,r.jsx)("strong",{children:"결제일"}),formatKoreanDateTime(e.created_at)]}),(0,r.jsxs)("div",{style:Q,children:[(0,r.jsx)("strong",{children:"금액"})," ",(0,F.T)(e.amount),"원"]}),(0,r.jsxs)("div",{style:Q,children:[(0,r.jsx)("strong",{children:"수강인원"})," ",e.quantity||0,"명"]}),(0,r.jsxs)("div",{style:Q,children:[(0,r.jsx)("strong",{children:"할인적용"})," ",(0,F.T)((e.used_point||0)+(e.coupon_discount||0)),"원"]}),(0,r.jsxs)("div",{style:Q,children:[(0,r.jsx)("strong",{children:"결제수단"})," ",e.payment_method||"-"]}),(0,r.jsxs)("div",{style:Q,children:[(0,r.jsx)("strong",{children:"상태"})," ",renderStatusBadge(getStatusLabel(e.status))]})]},e.order_id+"-"+t))}):(0,r.jsx)("div",{style:{overflowX:"auto"},children:(0,r.jsxs)("table",{style:A,children:[(0,r.jsx)("thead",{style:{background:"#f9f9f9"},children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{style:K,children:"No"}),(0,r.jsxs)("th",{style:K,onClick:()=>handleSort("order_id"),children:["주문번호",(0,r.jsx)("span",{style:{...Z,color:"order_id"===x.key?"#000":"#ccc"},children:"order_id"===x.key?"asc"===x.direction?"▲":"▼":"↕"})]}),(0,r.jsxs)("th",{style:K,onClick:()=>handleSort("created_at"),children:["결제일",(0,r.jsx)("span",{style:{...Z,color:"created_at"===x.key?"#000":"#ccc"},children:"created_at"===x.key?"asc"===x.direction?"▲":"▼":"↕"})]}),(0,r.jsxs)("th",{style:K,onClick:()=>handleSort("amount"),children:["금액",(0,r.jsx)("span",{style:{...Z,color:"amount"===x.key?"#000":"#ccc"},children:"amount"===x.key?"asc"===x.direction?"▲":"▼":"↕"})]}),(0,r.jsxs)("th",{style:K,onClick:()=>handleSort("total_quantity"),children:["수강인원",(0,r.jsx)("span",{style:{...Z,color:"total_quantity"===x.key?"#000":"#ccc"},children:"total_quantity"===x.key?"asc"===x.direction?"▲":"▼":"↕"})]}),(0,r.jsxs)("th",{style:K,onClick:()=>handleSort("discount_total"),children:["할인적용",(0,r.jsx)("span",{style:{...Z,color:"discount_total"===x.key?"#000":"#ccc"},children:"discount_total"===x.key?"asc"===x.direction?"▲":"▼":"↕"})]}),(0,r.jsxs)("th",{style:K,onClick:()=>handleSort("payment_method"),children:["결제수단",(0,r.jsx)("span",{style:{...Z,color:"payment_method"===x.key?"#000":"#ccc"},children:"payment_method"===x.key?"asc"===x.direction?"▲":"▼":"↕"})]}),(0,r.jsxs)("th",{style:K,onClick:()=>handleSort("status"),children:["상태",(0,r.jsx)("span",{style:{...Z,color:"status"===x.key?"#000":"#ccc"},children:"status"===x.key?"asc"===x.direction?"▲":"▼":"↕"})]})]})}),(0,r.jsx)("tbody",{children:C.map((e,t)=>(0,r.jsxs)("tr",{style:{backgroundColor:t%2==0?"#fff":"#fafafa",cursor:"pointer"},children:[(0,r.jsx)("td",{style:q,children:(f-1)*10+t+1}),(0,r.jsx)("td",{style:{...q,color:"#0070f3"},onClick:()=>n.push("/orders/".concat(e.order_id)),children:e.order_id}),(0,r.jsx)("td",{style:q,children:formatKoreanDateTime(e.created_at)}),(0,r.jsxs)("td",{style:q,children:[(0,F.T)(e.amount),"원"]}),(0,r.jsxs)("td",{style:q,children:[e.quantity||0,"명"]}),(0,r.jsxs)("td",{style:q,children:[(0,F.T)((e.used_point||0)+(e.coupon_discount||0)),"원"]}),(0,r.jsx)("td",{style:q,children:e.payment_method||"-"}),(0,r.jsx)("td",{style:q,children:renderStatusBadge(getStatusLabel(e.status))})]},e.order_id+"-"+t))})]})}),(0,r.jsx)("div",{style:{marginTop:"20px",textAlign:"center"},children:Array.from({length:k},(e,t)=>t+1).map(e=>(0,r.jsx)("button",{onClick:()=>y(e),style:{padding:"6px 10px",fontSize:"14px",border:"1px solid #ccc",borderRadius:"4px",margin:"0 4px",cursor:"pointer",fontWeight:f===e?"bold":"normal",backgroundColor:f===e?"#eee":"#fff"},children:e},e))})]})}let N={padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px",width:"140px"},A={width:"100%",borderCollapse:"collapse",fontSize:"15px",lineHeight:"1.6"},K={padding:"10px",textAlign:"center",fontWeight:"bold",cursor:"pointer"},q={padding:"12px",textAlign:"center"},Z={fontSize:"11px",marginLeft:"4px",verticalAlign:"middle"},H={fontSize:"1.4rem",fontWeight:"bold",marginBottom:"20px"},G={padding:"16px",border:"1px solid #ddd",borderRadius:"8px",background:"#fff",boxShadow:"0 1px 4px rgba(0,0,0,0.05)"},Q={marginBottom:"8px",fontSize:"14px",display:"flex",justifyContent:"space-between",gap:"8px"};function Coupons(e){let{data:t}=e,n=(0,d.dD)();return t?(0,r.jsxs)("div",{style:{padding:n?0:20},children:[!n&&(0,r.jsx)("h2",{style:X,children:"쿠폰"}),0===t.length?(0,r.jsx)("p",{children:"사용 가능한 쿠폰이 없습니다."}):(0,r.jsx)("div",{style:U,children:t.filter(e=>{let t=0===e.is_used,n=!e.expiry_date||new Date(e.expiry_date)>new Date;return t&&n}).map((e,t)=>{let n=function(e){if(!e)return"";let t=new Date(e);return isNaN(t.getTime())?e:t.toLocaleDateString("ko-KR")}(e.expiry_date);return(0,r.jsxs)("div",{style:Y,children:[(0,r.jsx)("h3",{style:J,children:e.name}),(0,r.jsx)("p",{style:V,children:"percent"===e.discount_type?"할인율: ".concat(e.discount_value,"%"):null!=e.discount_amount?"할인가격: ".concat((0,F.T)(e.discount_amount),"원"):"할인정보 없음"}),(0,r.jsx)("p",{style:V,children:e.expiry_date?"유효기한: ".concat(n):"유효기한: 제한없음"}),(0,r.jsxs)("p",{style:V,children:["상태: ",e.is_used?"사용됨":"사용가능"]})]},e.coupon_id||"coupon-".concat(t))})})]}):(0,r.jsx)(r.Fragment,{})}let X={fontSize:"1.2rem",marginBottom:"16px"},U={display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(240px, 1fr))",gap:"16px"},Y={border:"1px solid #ddd",borderRadius:"8px",padding:"16px",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",backgroundColor:"#fff"},J={marginBottom:"8px",fontSize:"1rem",fontWeight:"bold"},V={margin:"4px 0",fontSize:"0.9rem"};function Points(e){var t;let{data:n}=e,[o,l]=(0,i.useState)("전체"),s=[],a=new Map;null==n||n.forEach(e=>{if("사용"===e.change_type)a.set(e.amount,e);else{let t=a.get(e.amount);t?(s.push({...t,created_at:e.created_at,change_type:"사용"}),a.delete(e.amount)):s.push(e)}}),a.forEach(e=>s.push(e));let c=(0,d.dD)(),p=s.filter(e=>"전체"===o||e.change_type===o),u=(null===(t=n[0])||void 0===t?void 0:t.username)||"사용자",x=n.reduce((e,t)=>"적립"===t.change_type?e+t.amount:"사용"===t.change_type?e-t.amount:e,0),renderBadge=e=>(0,r.jsx)("span",{style:{backgroundColor:"적립"===e?"#10b981":"#ef4444",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px",minWidth:"40px",textAlign:"center",whiteSpace:"nowrap",display:"inline-block"},children:e});return(0,r.jsxs)("div",{style:{padding:c?0:20},children:[!c&&(0,r.jsx)("h2",{style:$,children:"포인트"}),(0,r.jsxs)("div",{style:ee,children:[(0,r.jsxs)("div",{style:et,children:[u,"님의 포인트"]}),(0,r.jsxs)("div",{style:en,children:[(0,F.T)(x),"P"]})]}),(0,r.jsx)("div",{style:er,children:["전체","적립","사용"].map(e=>(0,r.jsx)("button",{onClick:()=>l(e),style:{...ei,borderBottom:o===e?"2px solid #0070f3":"none",fontWeight:o===e?"bold":"normal"},children:e},e))}),0===p.length?(0,r.jsx)("p",{style:{marginTop:"16px"},children:"포인트 내역이 없습니다."}):(0,r.jsx)("div",{style:eo,children:(0,r.jsxs)("table",{style:el,children:[(0,r.jsx)("thead",{style:es,children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{style:ea,children:"구분"}),(0,r.jsx)("th",{style:ea,children:"금액"}),(0,r.jsx)("th",{style:ea,children:"설명"}),(0,r.jsx)("th",{style:ea,children:"적립일시"}),("전체"===o||"사용"===o)&&(0,r.jsx)("th",{style:ea,children:"사용일시"})]})}),(0,r.jsx)("tbody",{children:p.map((e,t)=>(0,r.jsxs)("tr",{style:t%2==0?ec:ep,children:[(0,r.jsx)("td",{style:ed,children:renderBadge(e.change_type)}),(0,r.jsxs)("td",{style:ed,children:[(0,F.T)(e.amount),"P"]}),(0,r.jsx)("td",{style:ed,children:e.description}),(0,r.jsx)("td",{style:ed,children:new Date(e.created_at).toLocaleDateString("ko-KR")}),("전체"===o||"사용"===o)&&(0,r.jsx)("td",{style:ed,children:e.used_at?new Date(e.used_at).toLocaleDateString("ko-KR"):"-"})]},e.point_id||t))})]})})]})}let $={fontSize:"1.2rem",marginBottom:"16px"},ee={display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f0f8ff",padding:"16px",borderRadius:"8px",marginBottom:"20px"},et={fontSize:"1rem",fontWeight:"bold"},en={fontSize:"1.2rem",fontWeight:"bold",color:"#0070f3"},er={display:"flex",gap:"16px",borderBottom:"1px solid #ccc",marginBottom:"12px"},ei={padding:"8px 12px",background:"none",border:"none",fontSize:"1rem",cursor:"pointer"},eo={overflowX:"auto"},el={width:"100%",borderCollapse:"collapse",fontSize:"15px",lineHeight:"1.6"},es={backgroundColor:"#f9f9f9",borderBottom:"1px solid #ddd"},ea={padding:"10px",textAlign:"center",fontWeight:"bold",fontSize:"14px",color:"#333"},ed={padding:"12px",textAlign:"center",fontSize:"14px",color:"#222"},ec={backgroundColor:"#fff"},ep={backgroundColor:"#fafafa"};function InquiryModal(e){let{onClose:t,onSubmitted:n}=e;if("function"!=typeof n)throw Error("❌ InquiryModal 사용 시 onSubmitted는 필수입니다.");let[o,s]=(0,i.useState)(""),[a,d]=(0,i.useState)(""),[c,p]=(0,i.useState)(null),[u,x]=(0,i.useState)(!1),handleSubmit=async e=>{e.preventDefault(),x(!0);let r=new FormData;r.append("title",o),r.append("message",a),c&&r.append("attachment",c);try{await l.ZP.post("/mypage/inquiries",r,{headers:{"Content-Type":"multipart/form-data"}}),alert("문의가 제출되었습니다."),"function"==typeof n&&n(),t()}catch(e){console.error("문의 제출 실패",e),alert("제출에 실패했습니다.")}finally{x(!1)}};return(0,r.jsx)("div",{style:eu,children:(0,r.jsxs)("div",{style:ex,children:[(0,r.jsx)("h2",{style:{marginBottom:20,fontSize:"1.2rem"},children:"\uD83D\uDCE9 1:1 문의 작성"}),(0,r.jsxs)("form",{onSubmit:handleSubmit,children:[(0,r.jsxs)("div",{style:eh,children:[(0,r.jsx)("label",{style:{display:"block",marginBottom:6,fontWeight:"bold"},children:"제목"}),(0,r.jsx)("input",{type:"text",value:o,onChange:e=>s(e.target.value),required:!0,style:ef})]}),(0,r.jsxs)("div",{style:eh,children:[(0,r.jsx)("label",{children:"내용"}),(0,r.jsx)("textarea",{value:a,onChange:e=>d(e.target.value),required:!0,style:ey})]}),(0,r.jsxs)("div",{style:eh,children:[(0,r.jsx)("label",{children:"첨부파일"}),(0,r.jsxs)("div",{style:eg,children:[(0,r.jsx)("input",{type:"file",onChange:e=>{p(e.target.files[0])}}),c&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{style:em,children:c.name}),(0,r.jsx)("button",{type:"button",onClick:()=>p(null),style:ej,title:"파일 삭제",children:"❌"})]})]})]}),(0,r.jsxs)("div",{style:eb,children:[(0,r.jsx)("button",{type:"button",onClick:t,style:ew,children:"닫기"}),(0,r.jsx)("button",{type:"submit",disabled:u,style:ev,children:u?"제출 중...":"제출"})]})]})]})})}let eu={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.4)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},ex={backgroundColor:"#fff",padding:"24px",borderRadius:"10px",width:"90%",maxWidth:"500px",boxShadow:"0 4px 16px rgba(0,0,0,0.2)",fontFamily:"Noto Sans KR, -apple-system, BlinkMacSystemFont, sans-serif"},eh={marginBottom:"16px"},ef={width:"100%",padding:"8px",fontSize:"0.95rem",borderRadius:"4px",border:"1px solid #ccc"},ey={...ef,resize:"vertical",minHeight:"100px"},eg={display:"flex",alignItems:"center",gap:"8px"},em={fontSize:"0.85rem",color:"#555",flexGrow:1,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},ej={cursor:"pointer",color:"#888",fontSize:"1rem",border:"none",background:"transparent"},eb={display:"flex",justifyContent:"flex-end",gap:"8px"},ev={backgroundColor:"#0070f3",color:"#fff",border:"none",borderRadius:"4px",padding:"8px 16px",fontSize:"0.9rem",cursor:"pointer"},ew={backgroundColor:"#f1f1f1",color:"#333",border:"1px solid #ccc",borderRadius:"4px",padding:"8px 16px",fontSize:"0.9rem",cursor:"pointer"};function Inquiries(e){let{data:t}=e,[n,o]=(0,i.useState)(t||[]),[s,a]=(0,i.useState)(!1),[c,p]=(0,i.useState)(null),u=(0,d.dD)(),fetchData=async()=>{try{let e=await l.ZP.get("/mypage/inquiries");e.data.success&&o(e.data.inquiries)}catch(e){console.error("❌ 문의 목록 조회 실패:",e)}};return n?(0,r.jsxs)("div",{style:{padding:u?0:20},children:[(0,r.jsxs)("div",{style:{display:"flex",flexDirection:u?"column":"row",alignItems:u?"stretch":"center",justifyContent:"space-between",gap:"10px",marginBottom:20},children:[!u&&(0,r.jsx)("h2",{style:eS,children:"1:1 문의내역"}),(0,r.jsx)("button",{onClick:()=>a(!0),style:{padding:u?"10px 0":"6px 12px",width:u?"100%":"auto",backgroundColor:"#0070f3",color:"#fff",border:"none",borderRadius:"6px",fontSize:"0.95rem",cursor:"pointer",marginTop:0},children:"문의하기"})]}),0===n.length?(0,r.jsx)("p",{style:{marginTop:20},children:"1:1 문의 내역이 없습니다."}):(0,r.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:12},children:n.map((e,t)=>{let n=c===t;return(0,r.jsxs)("div",{style:{border:"1px solid #ccc",borderRadius:8,padding:16,backgroundColor:"#fff",cursor:"pointer"},onClick:()=>p(n?null:t),children:[(0,r.jsxs)("div",{style:ek,children:[(0,r.jsx)("strong",{children:e.title}),(0,r.jsx)("span",{style:eR[e.status],children:e.status})]}),(0,r.jsxs)("div",{style:eC,children:[(0,r.jsxs)("span",{children:["작성일: ",Inquiries_formatDate(e.created_at)]}),(0,r.jsxs)("span",{children:["답변일:"," ",e.answered_at?Inquiries_formatDate(e.answered_at):"미답변"]})]}),n&&(0,r.jsxs)("div",{style:{marginTop:12},children:[(0,r.jsx)("div",{style:e_,children:"\uD83D\uDCE9 문의 내용"}),(0,r.jsx)("p",{style:eD,children:e.message}),e.attachment&&(0,r.jsx)("div",{style:{marginTop:8},children:(0,r.jsx)("button",{style:eI,onClick:t=>{t.stopPropagation(),window.open("/".concat(e.attachment),"_blank")},children:"\uD83D\uDCCE 첨부파일 다운로드"})}),(0,r.jsx)("div",{style:e_,children:"✅ 관리자 답변"}),(0,r.jsx)("p",{style:eD,children:e.answer||"아직 답변이 등록되지 않았습니다."}),"접수"===e.status&&(0,r.jsx)("div",{style:{textAlign:"right",marginTop:16},children:(0,r.jsx)("button",{style:ez,onClick:async t=>{if(t.stopPropagation(),confirm("정말 삭제하시겠습니까?"))try{await l.ZP.delete("/mypage/inquiries/".concat(e.id)),await fetchData()}catch(e){alert("삭제 실패"),console.error(e)}},children:"❌ 삭제"})})]})]},e.id||t)})}),s&&(0,r.jsx)(InquiryModal,{onClose:()=>a(!1),onSubmitted:()=>{fetchData(),a(!1)}})]}):(0,r.jsx)(r.Fragment,{})}let Inquiries_formatDate=e=>new Date(e).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}),eS={fontSize:"1.2rem",margin:0},ek={display:"flex",justifyContent:"space-between",alignItems:"center"},eC={display:"flex",justifyContent:"space-between",marginTop:6,fontSize:"13px",color:"#666"},e_={fontWeight:"bold",marginTop:12,fontSize:"14px",color:"#333"},eD={marginTop:6,fontSize:"14px",lineHeight:1.6,whiteSpace:"pre-line"},ez={background:"#f9f9f9",border:"1px solid #ccc",borderRadius:"6px",color:"#333",fontSize:"13px",padding:"4px 10px",cursor:"pointer"},eR={접수:{backgroundColor:"#ddd",padding:"2px 8px",borderRadius:12,fontSize:12,color:"#333"},답변완료:{backgroundColor:"#3b82f6",color:"#fff",padding:"2px 8px",borderRadius:12,fontSize:12}},eI={backgroundColor:"#f1f1f1",border:"1px solid #ccc",borderRadius:"6px",padding:"6px 12px",fontSize:"14px",cursor:"pointer",color:"#333"};function MyPage(){let e=(0,o.useRouter)(),[t,n]=(0,i.useState)("내 정보"),[s,a]=(0,i.useState)([]),[c,p]=(0,i.useState)(""),[u,x]=(0,i.useState)(!0),h=(0,d.dD)(),f=(0,i.useRef)(null),[y,g]=(0,i.useState)(!1);async function fetchData(e){x(!0),p(""),a([]);try{let t="";if("내 정보"===e?t="/mypage/info":"수강정보"===e?t="/mypage/courses":"결제내역"===e?t="/mypage/payments":"쿠폰"===e?t="/mypage/coupons":"포인트"===e?t="/mypage/points":"1:1문의"===e&&(t="/mypage/inquiries"),t){let e=await l.ZP.get(t);if(console.log("\uD83D\uDCE6 [MyPage] 응답 결과:",e.data),e.data&&e.data.success){let t=Object.keys(e.data).find(e=>"success"!==e);a(e.data[t]||[])}else p("데이터를 불러오지 못했습니다.")}}catch(e){console.error("마이페이지 로딩 오류:",e),p("마이페이지 로딩 중 오류가 발생했습니다.")}finally{x(!1)}}return(0,i.useEffect)(()=>{if(!e.isReady)return;let t=e.query.menu||"내 정보";n(t),fetchData(t)},[e.query.menu]),(0,i.useEffect)(()=>{let handleClickOutside=e=>{f.current&&!f.current.contains(e.target)&&g(!1)};return document.addEventListener("mousedown",handleClickOutside),()=>{document.removeEventListener("mousedown",handleClickOutside)}},[]),(0,r.jsx)("div",{style:{background:"#fefefe",minHeight:"100vh"},children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:h?"column":"row",alignItems:"stretch",minHeight:"100vh",width:"100%",overflow:"visible",position:"relative"},children:[h?(0,r.jsxs)("div",{ref:f,style:{position:"relative",margin:"16px 12px",width:"calc(100% - 24px)"},children:[(0,r.jsxs)("div",{onClick:()=>g(e=>!e),style:{border:"1px solid #ccc",borderRadius:"6px",padding:"10px 12px",background:"#fff",fontSize:"15px",fontWeight:"bold",cursor:"pointer",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,r.jsx)("span",{children:t}),(0,r.jsx)("span",{style:{fontSize:"13px",color:"#888"},children:"▾"})]}),y&&(0,r.jsx)("div",{style:{marginTop:"4px",border:"1px solid #ddd",borderRadius:"6px",background:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.1)",position:"absolute",zIndex:10,width:"100%"},children:["내 정보","수강정보","결제내역","쿠폰","포인트","1:1문의"].map(n=>(0,r.jsx)("div",{onClick:()=>{g(!1),e.push("/mypage?menu=".concat(n))},style:{padding:"10px 12px",borderBottom:"1px solid #f0f0f0",cursor:"pointer",background:t===n?"#f5f5f5":"#fff"},children:n},n))})]}):(0,r.jsx)(MyPageSidebar,{activeMenu:t,setActiveMenu:n}),(0,r.jsx)("div",{style:{flex:1,padding:h?"0 12px":"0 20px"},children:(()=>{if(u)return(0,r.jsx)(r.Fragment,{});if(c)return(0,r.jsxs)("div",{style:{padding:"20px"},children:[(0,r.jsx)("h2",{children:"에러 발생"}),(0,r.jsx)("p",{children:c})]});let e={data:s};switch(t){case"내 정보":return(0,r.jsx)(MyInfo,{...e});case"수강정보":default:return(0,r.jsx)(MyCourse,{...e});case"결제내역":return(0,r.jsx)(PaymentHistory,{...e});case"쿠폰":return(0,r.jsx)(Coupons,{...e});case"포인트":return(0,r.jsx)(Points,{...e});case"1:1문의":return(0,r.jsx)(Inquiries,{...e})}})()})]})})}s.Z.defaults.withCredentials=!0},5054:function(e,t,n){"use strict";n.d(t,{w_:function(){return GenIcon}});var r=n(7294),i={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},o=r.createContext&&r.createContext(i),l=["attr","size","title"];function _extends(){return(_extends=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){var r,i;r=t,i=n[t],(r=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(r))in e?Object.defineProperty(e,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[r]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function GenIcon(e){return t=>r.createElement(IconBase,_extends({attr:_objectSpread({},e.attr)},t),function Tree2Element(e){return e&&e.map((e,t)=>r.createElement(e.tag,_objectSpread({key:t},e.attr),Tree2Element(e.child)))}(e.child))}function IconBase(e){var elem=t=>{var n,{attr:i,size:o,title:s}=e,a=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,l),d=o||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),r.createElement("svg",_extends({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,i,a,{className:n,style:_objectSpread(_objectSpread({color:e.color||t.color},t.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),s&&r.createElement("title",null,s),e.children)};return void 0!==o?r.createElement(o.Consumer,null,e=>elem(e)):elem(i)}}},function(e){e.O(0,[2644,6342,594,4403,9774,2888,179],function(){return e(e.s=7614)}),_N_E=e.O()}]);