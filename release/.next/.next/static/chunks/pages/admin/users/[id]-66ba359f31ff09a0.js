(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[66],{3162:function(t,n,r){var o,l;void 0!==(l="function"==typeof(o=function(){"use strict";function c(t,n,r){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){l(o.response,n,r)},o.onerror=function(){console.error("could not download file")},o.send()}function d(t){var n=new XMLHttpRequest;n.open("HEAD",t,!1);try{n.send()}catch(t){}return 200<=n.status&&299>=n.status}function e(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(r){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r.g&&r.g.global===r.g?r.g:void 0,o=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(t,r,o){var l=n.URL||n.webkitURL,s=document.createElement("a");r=r||t.name||"download",s.download=r,s.rel="noopener","string"==typeof t?(s.href=t,s.origin===location.origin?e(s):d(s.href)?c(t,r,o):e(s,s.target="_blank")):(s.href=l.createObjectURL(t),setTimeout(function(){l.revokeObjectURL(s.href)},4e4),setTimeout(function(){e(s)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,r){if(n=n||t.name||"download","string"!=typeof t){var o;navigator.msSaveOrOpenBlob((void 0===(o=r)?o={autoBom:!1}:"object"!=typeof o&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t),n)}else if(d(t))c(t,n,r);else{var l=document.createElement("a");l.href=t,l.target="_blank",setTimeout(function(){e(l)})}}:function(t,r,l,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof t)return c(t,r,l);var i="application/octet-stream"===t.type,a=/constructor/i.test(n.HTMLElement)||n.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||i&&a||o)&&"undefined"!=typeof FileReader){var p=new FileReader;p.onloadend=function(){var t=p.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=t:location=t,s=null},p.readAsDataURL(t)}else{var x=n.URL||n.webkitURL,h=x.createObjectURL(t);s?s.location=h:location.href=h,s=null,setTimeout(function(){x.revokeObjectURL(h)},4e4)}});n.saveAs=l.saveAs=l,t.exports=l})?o.apply(n,[]):o)&&(t.exports=l)},5271:function(t,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users/[id]",function(){return r(9569)}])},1451:function(t,n,r){"use strict";r.d(n,{Z:function(){return PageSizeSelector}});var o=r(5893);function PageSizeSelector(t){let{value:n,onChange:r,options:l=[10,20,50,100],style:s={}}=t;return(0,o.jsx)("select",{value:n,onChange:t=>r(Number(t.target.value)),style:{padding:"8px",fontSize:"14px",borderRadius:"6px",...s},children:l.map(t=>(0,o.jsxs)("option",{value:t,children:[t,"개"]},t))})}},9075:function(t,n,r){"use strict";r.d(n,{Z:function(){return PaginationControls}});var o=r(5893);function PaginationControls(t){let{page:n,totalPages:r,onPageChange:l}=t;return(0,o.jsx)("div",{style:{width:"100%",textAlign:"center",marginTop:"16px"},children:(0,o.jsxs)("div",{style:{display:"inline-flex",justifyContent:"center",gap:"12px"},children:[(0,o.jsx)("button",{disabled:1===n,onClick:()=>l(n-1),style:{padding:"6px 10px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:1===n?"#f3f3f3":"#fff",color:"#000",cursor:1===n?"not-allowed":"pointer"},children:"◀"}),(0,o.jsxs)("span",{style:{alignSelf:"center"},children:[n," / ",r||1]}),(0,o.jsx)("button",{disabled:n===r,onClick:()=>l(n+1),style:{padding:"6px 10px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:n===r?"#f3f3f3":"#fff",color:"#000",cursor:n===r?"not-allowed":"pointer"},children:"▶"})]})})}r(7294)},67:function(){},2061:function(){},9018:function(t,n,r){"use strict";r.d(n,{Z:function(){return AdminLayout}});var o=r(5893),l=r(7294),s=r(1163),i=r(2091),a=r(6131);function AdminSidebar(){let t=(0,s.useRouter)(),[n,r]=(0,l.useState)(()=>"true"===localStorage.getItem("sidebar-collapsed")),u={color:"#fff",fontSize:"20px"};return(0,o.jsxs)("nav",{style:{position:"fixed",top:0,left:0,bottom:0,width:n?"60px":"150px",background:"#111827",padding:"10px",overflowY:"auto",display:"flex",flexDirection:"column",height:"100vh",zIndex:1e3},children:[(0,o.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"20px"},children:(0,o.jsx)("button",{onClick:()=>{r(t=>(localStorage.setItem("sidebar-collapsed",!t),!t))},style:{background:"none",border:"none",cursor:"pointer",color:"#fff"},children:n?(0,o.jsx)(i.Dli,{}):(0,o.jsx)(i.bUI,{})})}),(0,o.jsxs)("ul",{style:{padding:0,listStyle:"none",flex:1},children:[(0,o.jsx)("li",{style:{marginBottom:"15px"},children:(0,o.jsxs)("button",{onClick:()=>t.push("/admin"),style:{display:"flex",alignItems:"center",width:"100%",background:"none",border:"none",cursor:"pointer",color:"#fff"},children:[(0,o.jsx)(i.xng,{style:u}),!n&&(0,o.jsx)("span",{style:{marginLeft:"10px"},children:"홈"})]})}),(0,o.jsx)("li",{style:{marginBottom:"15px"},children:(0,o.jsxs)("button",{onClick:()=>t.push("/admin/products"),style:{display:"flex",alignItems:"center",width:"100%",background:"none",border:"none",cursor:"pointer",color:"#fff"},children:[(0,o.jsx)(i.AFA,{style:u}),!n&&(0,o.jsx)("span",{style:{marginLeft:"10px"},children:"상품관리"})]})}),(0,o.jsx)("li",{style:{marginBottom:"15px"},children:(0,o.jsxs)("button",{onClick:()=>t.push("/admin/schedules"),style:{display:"flex",alignItems:"center",width:"100%",background:"none",border:"none",cursor:"pointer",color:"#fff"},children:[(0,o.jsx)(i.IiJ,{style:u}),!n&&(0,o.jsx)("span",{style:{marginLeft:"10px"},children:"교육일정"})]})}),(0,o.jsx)("li",{style:{marginBottom:"15px"},children:(0,o.jsxs)("button",{onClick:()=>t.push("/admin/payments"),style:{display:"flex",alignItems:"center",width:"100%",background:"none",border:"none",cursor:"pointer",color:"#fff"},children:[(0,o.jsx)(i.ypE,{style:u}),!n&&(0,o.jsx)("span",{style:{marginLeft:"10px"},children:"결제관리"})]})}),(0,o.jsx)("li",{style:{marginBottom:"15px"},children:(0,o.jsxs)("button",{onClick:()=>t.push("/admin/users"),style:{display:"flex",alignItems:"center",width:"100%",background:"none",border:"none",cursor:"pointer",color:"#fff"},children:[(0,o.jsx)(i.Xws,{style:u}),!n&&(0,o.jsx)("span",{style:{marginLeft:"10px"},children:"사용자"})]})}),(0,o.jsx)("li",{style:{marginTop:"auto",paddingTop:"20px",borderTop:"1px solid #555"},children:(0,o.jsx)(a.Z,{collapsed:n})})]})]})}function AdminLayout(t){let{pageTitle:n,children:r}=t;return(0,o.jsxs)("div",{className:"admin-layout",style:{display:"flex",minHeight:"100vh"},children:[(0,o.jsx)(AdminSidebar,{}),(0,o.jsx)("main",{className:"admin-main",style:{flex:1,marginLeft:"150px",overflowY:"auto",backgroundColor:"inherit",height:"100vh"},children:(0,o.jsxs)("div",{style:{padding:"20px"},children:[n&&(0,o.jsx)("h1",{style:{fontSize:"2rem",fontWeight:"bold",marginTop:"0px",marginBottom:"20px"},children:n}),r]})})]})}},9569:function(t,n,r){"use strict";r.r(n),r.d(n,{default:function(){return AdminUserDetailPage}});var o=r(5893),l=r(1163),s=r(7294),i=r(9018),a=r(3504),u=r(1988);r(5890);var p=r(4105),x=r(3162),h=r(1451),f=r(9075);function UserCoursesTab(t){let{userId:n}=t,[r,i]=(0,s.useState)([]),[b,j]=(0,s.useState)([]),[v,w]=(0,s.useState)(1),[C,S]=(0,s.useState)(20),[k,_]=(0,s.useState)(null),[P,T]=(0,s.useState)(""),[A,E]=(0,s.useState)(null),[D,B]=(0,s.useState)(null),[O,R]=(0,s.useState)({key:"start_date",direction:"desc"}),L=(0,l.useRouter)();(0,s.useEffect)(()=>{n&&(a.ZP.get("/admin/users/".concat(n,"/courses")).then(t=>{let n=t.data.courses||[];i(n),j(n)}),a.ZP.get("/admin/users/".concat(n)).then(t=>{_(t.data.user)}))},[n]),(0,s.useEffect)(()=>{let t=[...r];if(A&&D){let n=A.getTime(),r=D.getTime();t=t.filter(t=>{let o=new Date(t.start_date).getTime();return o>=n&&o<=r})}if(P){let n=P.toLowerCase();t=t.filter(t=>{var r;return null===(r=t.title)||void 0===r?void 0:r.toLowerCase().includes(n)})}t.sort((t,n)=>{let{key:r,direction:o}=O,l=t[r],s=n[r],i=0;return i="string"==typeof l&&"string"==typeof s?l.localeCompare(s):new Date(l)-new Date(s),"asc"===o?i:-i}),j(t)},[r,A,D,P,O]),(0,s.useEffect)(()=>{window.scrollTo({top:0,behavior:"smooth"})},[v]);let M=(0,s.useMemo)(()=>{let t=(v-1)*C,n=t+C;return b.slice(t,n)},[b,v,C]),I=Math.ceil(b.length/C),renderStatusBadge=t=>(0,o.jsx)("span",{style:{backgroundColor:{예정:"#0070f3",진행중:"#FFA000",완료:"#4CAF50"}[t]||"#999",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px"},children:t}),renderArrow=t=>{let n={marginLeft:"6px",fontSize:"12px"};return O&&t===O.key?(0,o.jsx)("span",{style:{...n,color:"#000"},children:"asc"===O.direction?"▲":"▼"}):(0,o.jsx)("span",{style:{...n,color:"#ccc"},children:"↕"})},handleSort=t=>{R(n=>({key:t,direction:n.key===t&&"asc"===n.direction?"desc":"asc"}))};return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"16px"},children:[(0,o.jsx)("input",{type:"text",placeholder:"강의명 검색",value:P,onChange:t=>T(t.target.value),style:{...y,width:"200px"}}),(0,o.jsx)(u.ZP,{selected:A,onChange:t=>E(t),placeholderText:"시작일",dateFormat:"yyyy-MM-dd",customInput:(0,o.jsx)("input",{style:y})}),(0,o.jsx)(u.ZP,{selected:D,onChange:t=>B(t),placeholderText:"종료일",dateFormat:"yyyy-MM-dd",customInput:(0,o.jsx)("input",{style:y})}),(0,o.jsx)("button",{onClick:()=>{E(null),B(null),T("")},style:buttonStyle("#ccc","#333"),children:"초기화"}),(0,o.jsx)("button",{onClick:()=>{let t=b.map(t=>{var n,r,o;return{강의명:t.title,시작일:null===(n=t.start_date)||void 0===n?void 0:n.slice(0,10),종료일:null===(r=t.end_date)||void 0===r?void 0:r.slice(0,10),주문일:null===(o=t.order_date)||void 0===o?void 0:o.slice(0,10),상태:t.status}}),n=p.P6.json_to_sheet(t),r=p.P6.book_new();p.P6.book_append_sheet(r,n,"수강정보");let o=new Date().toISOString().slice(0,10).replace(/-/g,""),l=(null==k?void 0:k.username)||"user",s=(null==k?void 0:k.email)||"email",i="수강정보_".concat(l,"(").concat(s,")_").concat(o,".xlsx"),a=p.cW(r,{bookType:"xlsx",type:"array"}),u=new Blob([a],{type:"application/octet-stream"});(0,x.saveAs)(u,i)},style:buttonStyle("#4CAF50","#fff"),children:"EXCEL"})]}),(0,o.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"12px"},children:(0,o.jsx)(h.Z,{value:C,onChange:t=>{S(t),w(1)}})}),(0,o.jsx)("div",{style:{overflowX:"auto"},children:0===b.length?(0,o.jsx)("p",{children:"수강 내역이 없습니다."}):(0,o.jsxs)("table",{style:{width:"100%",fontSize:"15px",borderCollapse:"collapse",lineHeight:"1.6"},children:[(0,o.jsx)("thead",{style:{background:"#f9f9f9"},children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:g,children:"NO"}),(0,o.jsxs)("th",{style:{...g,cursor:"pointer"},onClick:()=>handleSort("start_date"),children:["시작일 ",renderArrow("start_date")]}),(0,o.jsxs)("th",{style:{...g,cursor:"pointer"},onClick:()=>handleSort("end_date"),children:["종료일 ",renderArrow("end_date")]}),(0,o.jsxs)("th",{style:{...g,cursor:"pointer"},onClick:()=>handleSort("order_date"),children:["주문일 ",renderArrow("order_date")]}),(0,o.jsxs)("th",{style:{...g,cursor:"pointer"},onClick:()=>handleSort("title"),children:["강의명 ",renderArrow("title")]}),(0,o.jsxs)("th",{style:{...g,cursor:"pointer"},onClick:()=>handleSort("status"),children:["상태 ",renderArrow("status")]})]})}),(0,o.jsx)("tbody",{children:M.map((t,n)=>{var r,l,s;return(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #eee",backgroundColor:n%2==0?"#fff":"#fafafa"},children:[(0,o.jsx)("td",{style:m,children:b.length-((v-1)*C+n)}),(0,o.jsx)("td",{style:m,children:null===(r=t.start_date)||void 0===r?void 0:r.slice(0,10)}),(0,o.jsx)("td",{style:m,children:null===(l=t.end_date)||void 0===l?void 0:l.slice(0,10)}),(0,o.jsx)("td",{style:m,children:null===(s=t.order_date)||void 0===s?void 0:s.slice(0,10)}),(0,o.jsx)("td",{style:{...m,color:"#0070f3",cursor:"pointer",textDecoration:"underline"},onClick:()=>L.push("/education/".concat(t.product_type,"/").concat(t.schedule_id)),children:t.title}),(0,o.jsx)("td",{style:m,children:renderStatusBadge(t.status)})]},n)})})]})}),(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"16px"},children:(0,o.jsx)(f.Z,{page:v,totalPages:I,onPageChange:w})})]})}let y={padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px",width:"140px"},buttonStyle=(t,n)=>({padding:"8px 14px",backgroundColor:t,color:n,border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer"}),g={padding:"12px",textAlign:"center",fontWeight:"bold"},m={padding:"12px",textAlign:"center"};function UserPaymentsTab(t){let{userId:n}=t,[r,l]=(0,s.useState)([]),[i,y]=(0,s.useState)([]),[g,m]=(0,s.useState)(1),[w,C]=(0,s.useState)(20),[S,k]=(0,s.useState)(null),[_,P]=(0,s.useState)(""),[T,A]=(0,s.useState)(""),[E,D]=(0,s.useState)(null),[B,O]=(0,s.useState)(null),[R,L]=(0,s.useState)({key:"created_at",direction:"desc"}),renderArrow=t=>{let n={marginLeft:"6px",fontSize:"12px"};return R&&t===R.key?(0,o.jsx)("span",{style:{...n,color:"#000"},children:"asc"===R.direction?"▲":"▼"}):(0,o.jsx)("span",{style:{...n,color:"#ccc"},children:"↕"})},fetchPayments=()=>{a.ZP.get("/admin/users/".concat(n,"/payments")).then(t=>{let n=t.data.payments||[];l(n),y(n)}),a.ZP.get("/admin/users/".concat(n)).then(t=>{k(t.data.user)})};(0,s.useEffect)(()=>{n&&fetchPayments()},[n]),(0,s.useEffect)(()=>{let t=[...r];if(_&&(t=t.filter(t=>t.status===_)),E&&B){let n=E.getTime(),r=B.getTime();t=t.filter(t=>{let o=new Date(t.created_at).getTime();return o>=n&&o<=r})}if(T){let n=T.toLowerCase();t=t.filter(t=>{var r;return null===(r=t.payment_method)||void 0===r?void 0:r.toLowerCase().includes(n)})}t.sort((t,n)=>{let{key:r,direction:o}=R,l=t[r],s=n[r],i=0;return"string"==typeof l&&"string"==typeof s?i=l.localeCompare(s):isNaN(Date.parse(l))||isNaN(Date.parse(s))?"number"==typeof l&&"number"==typeof s&&(i=l-s):i=new Date(l)-new Date(s),"asc"===o?i:-i}),y(t)},[r,_,T,E,B,R]);let M=(0,s.useMemo)(()=>{let t=(g-1)*w,n=t+w;return i.slice(t,n)},[i,g,w]),I=Math.ceil(i.length/w),handleSort=t=>{L(n=>({key:t,direction:n.key===t&&"asc"===n.direction?"desc":"asc"}))};(0,s.useEffect)(()=>{window.scrollTo({top:0,behavior:"smooth"})},[g]);let renderBadge=t=>(0,o.jsx)("span",{style:{backgroundColor:{paid:"#4CAF50",pending:"#FFA000",canceled:"#f44336",refunded:"#9E9E9E"}[t]||"#999",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px"},children:{paid:"결제완료",pending:"대기중",canceled:"취소됨",refunded:"환불됨"}[t]||t});return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"16px"},children:[(0,o.jsxs)("select",{value:_,onChange:t=>P(t.target.value),style:b,children:[(0,o.jsx)("option",{value:"",children:"전체 상태"}),(0,o.jsx)("option",{value:"paid",children:"결제완료"}),(0,o.jsx)("option",{value:"pending",children:"대기중"}),(0,o.jsx)("option",{value:"canceled",children:"취소됨"})]}),(0,o.jsx)(u.ZP,{selected:E,onChange:t=>D(t),placeholderText:"시작일",dateFormat:"yyyy-MM-dd",customInput:(0,o.jsx)("input",{style:b})}),(0,o.jsx)(u.ZP,{selected:B,onChange:t=>O(t),placeholderText:"종료일",dateFormat:"yyyy-MM-dd",customInput:(0,o.jsx)("input",{style:b})}),(0,o.jsx)("input",{type:"text",placeholder:"결제수단 검색",value:T,onChange:t=>A(t.target.value),style:{...b,width:"200px"}}),(0,o.jsx)("button",{onClick:()=>{P(""),A(""),D(null),O(null)},style:UserPaymentsTab_buttonStyle("#ccc","#333"),children:"초기화"}),(0,o.jsx)("button",{onClick:()=>{let t=i.map(t=>{let n=new Date(t.created_at).toLocaleString("ko-KR"),r=t.refunded_at?new Date(t.refunded_at).toLocaleString("ko-KR"):null;return{금액:t.amount,결제수단:t.payment_method,상태:t.status,일시:r?"".concat(n," (").concat(r,")"):n}}),n=p.P6.json_to_sheet(t),r=p.P6.book_new();p.P6.book_append_sheet(r,n,"결제내역");let o=new Date().toISOString().slice(0,10).replace(/-/g,""),l=(null==S?void 0:S.username)||"user",s=(null==S?void 0:S.email)||"email",a="결제내역_".concat(l,"(").concat(s,")_").concat(o,".xlsx"),u=p.cW(r,{bookType:"xlsx",type:"array"}),h=new Blob([u],{type:"application/octet-stream"});(0,x.saveAs)(h,a)},style:UserPaymentsTab_buttonStyle("#4CAF50","#fff"),children:"EXCEL"})]}),(0,o.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"12px"},children:(0,o.jsx)(h.Z,{value:w,onChange:t=>{C(t),m(1)}})}),(0,o.jsx)("div",{style:{overflowX:"auto"},children:0===i.length?(0,o.jsx)("p",{children:"결제내역이 없습니다."}):(0,o.jsxs)("table",{style:{width:"100%",fontSize:"15px",borderCollapse:"collapse",lineHeight:"1.6"},children:[(0,o.jsx)("thead",{style:{background:"#f9f9f9"},children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:j,children:"NO"}),(0,o.jsxs)("th",{style:{...j,width:"30%",cursor:"pointer"},onClick:()=>handleSort("created_at"),children:["일시 ",renderArrow("created_at")]}),(0,o.jsxs)("th",{style:{...j,width:"35%",cursor:"pointer"},onClick:()=>handleSort("product_titles"),children:["상품명 ",renderArrow("product_titles")]}),(0,o.jsxs)("th",{style:{...j,width:"10%",cursor:"pointer"},onClick:()=>handleSort("amount"),children:["금액 ",renderArrow("amount")]}),(0,o.jsxs)("th",{style:{...j,width:"15%",cursor:"pointer"},onClick:()=>handleSort("payment_method"),children:["결제수단 ",renderArrow("payment_method")]}),(0,o.jsxs)("th",{style:{...j,width:"10%",cursor:"pointer"},onClick:()=>handleSort("status"),children:["상태 ",renderArrow("status")]})]})}),(0,o.jsx)("tbody",{children:M.map((t,n)=>(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #eee",backgroundColor:n%2==0?"#fff":"#fafafa"},children:[(0,o.jsx)("td",{style:v,children:i.length-((g-1)*w+n)}),(0,o.jsxs)("td",{style:v,children:[new Date(t.created_at).toLocaleString("ko-KR"),t.refunded_at&&(0,o.jsxs)("div",{style:{fontSize:"13px",color:"#666",marginTop:"4px"},children:["(",new Date(t.refunded_at).toLocaleString("ko-KR"),")"]})]}),(0,o.jsx)("td",{style:v,children:(0,o.jsx)("span",{style:{cursor:"pointer",color:"#0070f3",textDecoration:"underline"},onClick:()=>alert(t.product_titles),children:t.product_titles?t.product_titles.split(", ")[0]+(t.product_titles.includes(", ")?" 등":""):"-"})}),(0,o.jsxs)("td",{style:v,children:[Number(t.amount).toLocaleString(),"원"]}),(0,o.jsx)("td",{style:v,children:t.payment_method}),(0,o.jsx)("td",{style:v,children:renderBadge(t.status)})]},n))})]})}),(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"16px"},children:(0,o.jsx)(f.Z,{page:g,totalPages:I,onPageChange:m})})]})}let b={padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px",width:"140px"},UserPaymentsTab_buttonStyle=(t,n)=>({padding:"8px 14px",backgroundColor:t,color:n,border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer"}),j={padding:"12px",textAlign:"center",fontWeight:"bold"},v={padding:"12px",textAlign:"center"};function UserPointsTab(t){let{userId:n}=t,[r,l]=(0,s.useState)([]),[i,y]=(0,s.useState)([]),[g,m]=(0,s.useState)(null),[b,j]=(0,s.useState)(""),[v,A]=(0,s.useState)(""),[E,D]=(0,s.useState)(null),[B,O]=(0,s.useState)(null),[R,L]=(0,s.useState)({key:"created_at",direction:"desc"}),[M,I]=(0,s.useState)(1),[F,z]=(0,s.useState)(20),fetchPoints=()=>{a.ZP.get("/admin/users/".concat(n,"/points")).then(t=>{let n=t.data.points||[];l(n),y(n)}),a.ZP.get("/admin/users/".concat(n)).then(t=>{m(t.data.user)})};(0,s.useEffect)(()=>{n&&fetchPoints()},[n]),(0,s.useEffect)(()=>{let t=[...r];if(b&&(t=t.filter(t=>t.change_type===b)),E&&B){let n=E.getTime(),r=B.getTime();t=t.filter(t=>{let o=new Date(t.created_at).getTime();return o>=n&&o<=r})}if(v){let n=v.toLowerCase();t=t.filter(t=>{var r;return null===(r=t.description)||void 0===r?void 0:r.toLowerCase().includes(n)})}t.sort((t,n)=>{let{key:r,direction:o}=R,l=t[r],s=n[r];return"created_at"===r?"asc"===o?new Date(l)-new Date(s):new Date(s)-new Date(l):"string"==typeof l&&"string"==typeof s?"asc"===o?l.localeCompare(s):s.localeCompare(l):"number"==typeof l&&"number"==typeof s?"asc"===o?l-s:s-l:0}),y(t)},[r,b,E,B,v,R]),(0,s.useEffect)(()=>{window.scrollTo({top:0,behavior:"smooth"})},[M]);let U=(0,s.useMemo)(()=>{let t=(M-1)*F,n=t+F;return i.slice(t,n)},[i,M,F]),Z=Math.ceil(i.length/F),handleSort=t=>{L(n=>({key:t,direction:n.key===t&&"asc"===n.direction?"desc":"asc"}))},renderArrow=t=>{let n={marginLeft:"6px",fontSize:"12px"};return R&&t===R.key?(0,o.jsx)("span",{style:{...n,color:"#000"},children:"asc"===R.direction?"▲":"▼"}):(0,o.jsx)("span",{style:{...n,color:"#ccc"},children:"↕"})},renderBadge=t=>(0,o.jsx)("span",{style:{backgroundColor:"적립"===t?"#0070f3":"#f44336",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px"},children:t});return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"16px"},children:[(0,o.jsxs)("select",{value:b,onChange:t=>j(t.target.value),style:w,children:[(0,o.jsx)("option",{value:"",children:"전체"}),(0,o.jsx)("option",{value:"적립",children:"적립"}),(0,o.jsx)("option",{value:"사용",children:"사용"})]}),(0,o.jsx)(u.ZP,{selected:E,onChange:t=>D(t),placeholderText:"시작일",dateFormat:"yyyy-MM-dd",customInput:(0,o.jsx)("input",{style:w})}),(0,o.jsx)(u.ZP,{selected:B,onChange:t=>O(t),placeholderText:"종료일",dateFormat:"yyyy-MM-dd",customInput:(0,o.jsx)("input",{style:w})}),(0,o.jsx)("input",{type:"text",placeholder:"설명 검색",value:v,onChange:t=>A(t.target.value),style:{...w,width:"200px"}}),(0,o.jsx)("button",{onClick:()=>{j(""),A(""),D(null),O(null)},style:UserPointsTab_buttonStyle("#ccc","#333"),children:"초기화"}),(0,o.jsx)("button",{onClick:()=>{let t=i.map(t=>{var n;return{일시:null===(n=t.created_at)||void 0===n?void 0:n.slice(0,19).replace("T"," "),상태:t.change_type,금액:t.amount,설명:t.description||"-"}}),n=p.P6.json_to_sheet(t),r=p.P6.book_new();p.P6.book_append_sheet(r,n,"포인트");let o=new Date().toISOString().slice(0,10).replace(/-/g,""),l=(null==g?void 0:g.username)||"user",s=(null==g?void 0:g.email)||"email",a="포인트_".concat(l,"(").concat(s,")_").concat(o,".xlsx"),u=p.cW(r,{bookType:"xlsx",type:"array"}),h=new Blob([u],{type:"application/octet-stream"});(0,x.saveAs)(h,a)},style:UserPointsTab_buttonStyle("#4CAF50","#fff"),children:"다운로드"})]}),(0,o.jsxs)("div",{style:{overflowX:"auto"},children:[(0,o.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"8px"},children:(0,o.jsx)(h.Z,{value:F,onChange:t=>{z(t),I(1)}})}),0===i.length?(0,o.jsx)("p",{children:"포인트 내역이 없습니다."}):(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("table",{style:{width:"100%",fontSize:"15px",borderCollapse:"collapse",lineHeight:"1.6"},children:[(0,o.jsx)("thead",{style:{background:"#f9f9f9"},children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:k,children:"NO"}),(0,o.jsxs)("th",{style:{...S,cursor:"pointer"},onClick:()=>handleSort("created_at"),children:["일시 ",renderArrow("created_at")]}),(0,o.jsxs)("th",{style:{...k,cursor:"pointer"},onClick:()=>handleSort("change_type"),children:["상태 ",renderArrow("change_type")]}),(0,o.jsxs)("th",{style:{...S,cursor:"pointer"},onClick:()=>handleSort("amount"),children:["금액 ",renderArrow("amount")]}),(0,o.jsxs)("th",{style:{...C,cursor:"pointer"},onClick:()=>handleSort("description"),children:["설명 ",renderArrow("description")]})]})}),(0,o.jsx)("tbody",{children:U.map((t,n)=>(0,o.jsxs)("tr",{style:{borderBottom:"1px solid #eee",backgroundColor:n%2==0?"#fff":"#fafafa"},children:[(0,o.jsx)("td",{style:T,children:i.length-((M-1)*F+n)}),(0,o.jsx)("td",{style:P,children:new Date(t.created_at).toLocaleString()}),(0,o.jsx)("td",{style:T,children:renderBadge(t.change_type)}),(0,o.jsxs)("td",{style:P,children:[Number(t.amount).toLocaleString(),"P"]}),(0,o.jsx)("td",{style:_,children:t.description||"-"})]},n))})]})})]}),(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"16px"},children:(0,o.jsx)(f.Z,{page:M,totalPages:Z,onPageChange:I})})]})}let w={padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px",width:"140px"},UserPointsTab_buttonStyle=(t,n)=>({padding:"8px 14px",backgroundColor:t,color:n,border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer"}),C={padding:"12px",textAlign:"center",fontWeight:"bold"},S={padding:"12px",textAlign:"center",fontWeight:"bold"},k={padding:"12px",textAlign:"center",fontWeight:"bold"},_={padding:"12px",textAlign:"center"},P={padding:"12px",textAlign:"center"},T={padding:"12px",textAlign:"center"};function UserCouponsTab(t){let{userId:n}=t,[r,l]=(0,s.useState)([]),[i,y]=(0,s.useState)([]),[g,m]=(0,s.useState)(null),[b,j]=(0,s.useState)(1),[v,w]=(0,s.useState)(20),[C,S]=(0,s.useState)(""),[k,_]=(0,s.useState)(""),[P,T]=(0,s.useState)(null),[B,O]=(0,s.useState)(null),[R,L]=(0,s.useState)({key:"expiry_date",direction:"desc"}),renderArrow=t=>{let n={marginLeft:"6px",fontSize:"12px"};return R&&t===R.key?(0,o.jsx)("span",{style:{...n,color:"#000"},children:"asc"===R.direction?"▲":"▼"}):(0,o.jsx)("span",{style:{...n,color:"#ccc"},children:"↕"})};(0,s.useEffect)(()=>{n&&(a.ZP.get("/admin/users/".concat(n,"/coupons")).then(t=>{let n=t.data.coupons||[];l(n),y(n)}),a.ZP.get("/admin/users/".concat(n)).then(t=>{m(t.data.user)}))},[n]),(0,s.useEffect)(()=>{let t=[...r];if(C&&(t=t.filter(t=>"used"===C?1===t.is_used:0===t.is_used)),P&&B){let n=P.getTime(),r=B.getTime();t=t.filter(t=>{let o=new Date(t.expiry_date).getTime();return o>=n&&o<=r})}if(k){let n=k.toLowerCase();t=t.filter(t=>{var r;return null===(r=t.name)||void 0===r?void 0:r.toLowerCase().includes(n)})}t.sort((t,n)=>{let{key:r,direction:o}=R;return"expiry_date"===r?"asc"===o?new Date(t[r])-new Date(n[r]):new Date(n[r])-new Date(t[r]):"string"==typeof t[r]&&"string"==typeof n[r]?"asc"===o?t[r].localeCompare(n[r]):n[r].localeCompare(t[r]):"number"==typeof t[r]&&"number"==typeof n[r]?"asc"===o?t[r]-n[r]:n[r]-t[r]:0}),y(t)},[r,C,P,B,k,R]);let M=(0,s.useMemo)(()=>{let t=(b-1)*v,n=t+v;return i.slice(t,n)},[i,b,v]),I=Math.ceil(i.length/v);(0,s.useEffect)(()=>{window.scrollTo({top:0,behavior:"smooth"})},[b]);let handleSort=t=>{L(n=>({key:t,direction:n.key===t&&"asc"===n.direction?"desc":"asc"})),window.scrollTo({top:0,behavior:"smooth"})},renderBadge=t=>(0,o.jsx)("span",{style:{backgroundColor:t?"#f44336":"#4CAF50",color:"#fff",padding:"4px 8px",borderRadius:"12px",fontSize:"12px"},children:t?"사용됨":"미사용"});return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{display:"flex",gap:"10px",flexWrap:"wrap",marginBottom:"16px"},children:[(0,o.jsxs)("select",{value:C,onChange:t=>S(t.target.value),style:A,children:[(0,o.jsx)("option",{value:"",children:"전체"}),(0,o.jsx)("option",{value:"unused",children:"미사용"}),(0,o.jsx)("option",{value:"used",children:"사용됨"})]}),(0,o.jsx)(u.ZP,{selected:P,onChange:t=>T(t),placeholderText:"만료 시작일",dateFormat:"yyyy-MM-dd",customInput:(0,o.jsx)("input",{style:A})}),(0,o.jsx)(u.ZP,{selected:B,onChange:t=>O(t),placeholderText:"만료 종료일",dateFormat:"yyyy-MM-dd",customInput:(0,o.jsx)("input",{style:A})}),(0,o.jsx)("input",{type:"text",placeholder:"쿠폰명 검색",value:k,onChange:t=>_(t.target.value),style:{...A,width:"200px"}}),(0,o.jsx)("button",{onClick:()=>{S(""),_(""),T(null),O(null)},style:UserCouponsTab_buttonStyle("#ccc","#333"),children:"초기화"}),(0,o.jsx)("button",{onClick:()=>{let t=i.map(t=>{var n;return{쿠폰명:t.name,할인액:t.discount_amount,상태:t.is_used?"사용됨":"미사용",만료일:null===(n=t.expiry_date)||void 0===n?void 0:n.slice(0,10)}}),n=p.P6.json_to_sheet(t),r=p.P6.book_new();p.P6.book_append_sheet(r,n,"쿠폰");let o=new Date().toISOString().slice(0,10).replace(/-/g,""),l=(null==g?void 0:g.username)||"user",s=(null==g?void 0:g.email)||"email",a="쿠폰_".concat(l,"(").concat(s,")_").concat(o,".xlsx"),u=p.cW(r,{bookType:"xlsx",type:"array"}),h=new Blob([u],{type:"application/octet-stream"});(0,x.saveAs)(h,a)},style:UserCouponsTab_buttonStyle("#4CAF50","#fff"),children:"EXCEL"})]}),(0,o.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"12px"},children:(0,o.jsx)(h.Z,{value:v,onChange:t=>{w(t),j(1)}})}),(0,o.jsx)("div",{style:{overflowX:"auto"},children:0===i.length?(0,o.jsx)("p",{children:"쿠폰 내역이 없습니다."}):(0,o.jsxs)("table",{style:{width:"100%",fontSize:"15px",borderCollapse:"collapse",lineHeight:"1.6"},children:[(0,o.jsx)("thead",{style:{background:"#f9f9f9"},children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{style:E,children:"NO"}),(0,o.jsxs)("th",{style:{...E,cursor:"pointer"},onClick:()=>handleSort("name"),children:["쿠폰명 ",renderArrow("name")]}),(0,o.jsxs)("th",{style:{...E,cursor:"pointer"},onClick:()=>handleSort("discount_amount"),children:["할인액 ",renderArrow("discount_amount")]}),(0,o.jsxs)("th",{style:{...E,cursor:"pointer"},onClick:()=>handleSort("is_used"),children:["상태 ",renderArrow("is_used")]}),(0,o.jsxs)("th",{style:{...E,cursor:"pointer"},onClick:()=>handleSort("expiry_date"),children:["만료일"," ","expiry_date"===R.key&&("asc"===R.direction?"▲":"▼")]})]})}),(0,o.jsx)("tbody",{children:M.map((t,n)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{style:D,children:i.length-((b-1)*v+n)}),(0,o.jsx)("td",{style:D,children:t.coupon_name}),(0,o.jsxs)("td",{style:D,children:[Number(t.discount_amount).toLocaleString(),"원"]}),(0,o.jsx)("td",{style:D,children:renderBadge(t.is_used)}),(0,o.jsx)("td",{style:D,children:t.expiry_date?t.expiry_date.slice(0,10):"없음"})]},n))})]})}),(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:"16px"},children:(0,o.jsx)(f.Z,{page:b,totalPages:I,onPageChange:j})})]})}let A={padding:"8px",borderRadius:"6px",border:"1px solid #ccc",fontSize:"14px",width:"140px"},UserCouponsTab_buttonStyle=(t,n)=>({padding:"8px 14px",backgroundColor:t,color:n,border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer"}),E={padding:"12px",textAlign:"center",fontWeight:"bold"},D={padding:"12px",textAlign:"center"};function UserTabs(t){let{userId:n}=t,[r,l]=(0,s.useState)("courses"),tabButtonStyle=t=>({padding:"10px 16px",background:"none",cursor:"pointer",borderTop:"none",borderLeft:"none",borderRight:"none",borderBottom:r===t?"3px solid #0070f3":"none",fontWeight:r===t?"bold":"normal"});return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{style:{display:"flex",gap:"10px",marginBottom:"16px",borderBottom:"1px solid #ccc"},children:[(0,o.jsx)("button",{style:tabButtonStyle("courses"),onClick:()=>l("courses"),children:"\uD83D\uDCDA 수강정보"}),(0,o.jsx)("button",{style:tabButtonStyle("payments"),onClick:()=>l("payments"),children:"\uD83E\uDDFE 결제내역"}),(0,o.jsx)("button",{style:tabButtonStyle("points"),onClick:()=>l("points"),children:"\uD83D\uDCB0 포인트"}),(0,o.jsx)("button",{style:tabButtonStyle("coupons"),onClick:()=>l("coupons"),children:"\uD83C\uDF9F 쿠폰"})]}),(0,o.jsxs)("div",{children:["courses"===r&&(0,o.jsx)(UserCoursesTab,{userId:n}),"payments"===r&&(0,o.jsx)(UserPaymentsTab,{userId:n}),"points"===r&&(0,o.jsx)(UserPointsTab,{userId:n}),"coupons"===r&&(0,o.jsx)(UserCouponsTab,{userId:n})]})]})}function AlertModal(t){let{message:n,onClose:r}=t;return(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.3)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:2e3},children:(0,o.jsxs)("div",{style:{background:"#fff",padding:"20px",borderRadius:"8px",width:"320px",textAlign:"center",boxShadow:"0 4px 8px rgba(0,0,0,0.1)"},children:[(0,o.jsx)("p",{style:{marginBottom:"20px"},children:n}),(0,o.jsx)("button",{style:{padding:"6px 16px",backgroundColor:"#4f46e5",color:"#fff",border:"none",borderRadius:"5px",cursor:"pointer"},onClick:r,autoFocus:!0,children:"확인"})]})})}function ConfirmModal(t){let{message:n,onConfirm:r,onCancel:l}=t;return(0,o.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:2e3},children:(0,o.jsxs)("div",{style:{background:"#fff",padding:"20px",borderRadius:"8px",width:"320px",textAlign:"center",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:[(0,o.jsx)("p",{style:{marginBottom:"20px"},children:n}),(0,o.jsx)("button",{onClick:r,style:{padding:"6px 12px",backgroundColor:"#4f46e5",color:"#fff",borderRadius:"5px",cursor:"pointer",marginRight:"5px"},children:"예"}),(0,o.jsx)("button",{onClick:l,style:{padding:"6px 12px",marginLeft:"5px"},children:"아니오"})]})})}function HistoryModal(t){let{userId:n,onClose:r}=t,[l,i]=(0,s.useState)([]),[u,p]=(0,s.useState)(1),[x,h]=(0,s.useState)(0);return(0,s.useEffect)(()=>{a.ZP.get("/admin/users/".concat(n,"/history?page=").concat(u,"&limit=").concat(5)).then(t=>{i(t.data.history),h(t.data.total)}).catch(t=>{console.error("❌ 이력 불러오기 실패:",t)})},[n,u]),(0,s.useEffect)(()=>{let handleEsc=t=>{"Escape"===t.key&&r()};return window.addEventListener("keydown",handleEsc),()=>window.removeEventListener("keydown",handleEsc)},[r]),(0,o.jsx)("div",{style:B,children:(0,o.jsxs)("div",{style:O,children:[(0,o.jsx)("h3",{style:{marginBottom:"20px",fontSize:"20px"},children:"\uD83D\uDD52 사용자 수정 이력"}),(0,o.jsxs)("table",{style:R,children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{style:L,children:[(0,o.jsx)("th",{style:M,children:"수정일시"}),(0,o.jsx)("th",{style:M,children:"항목"}),(0,o.jsx)("th",{style:M,children:"변경 전"}),(0,o.jsx)("th",{style:M,children:"변경 후"}),(0,o.jsx)("th",{style:M,children:"수정자"}),(0,o.jsx)("th",{style:M,children:"권한"}),(0,o.jsx)("th",{style:M,children:"위치"})]})}),(0,o.jsx)("tbody",{children:l.length>0?l.map(t=>{var n,r,l;return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{style:I,children:new Date(t.changed_at).toLocaleString("ko-KR")}),(0,o.jsx)("td",{style:I,children:t.field}),(0,o.jsx)("td",{style:I,children:t.old_value}),(0,o.jsx)("td",{style:I,children:t.new_value}),(0,o.jsx)("td",{style:I,children:null!==(n=t.modifier_email)&&void 0!==n?n:"-"}),(0,o.jsx)("td",{style:I,children:null!==(r=t.modifier_role)&&void 0!==r?r:"-"}),(0,o.jsx)("td",{style:I,children:null!==(l=t.origin)&&void 0!==l?l:"-"})]},t.id)}):(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"7",style:{textAlign:"center",padding:"16px"},children:"수정 이력이 없습니다."})})})]}),(0,o.jsxs)("div",{style:F,children:[(0,o.jsx)("button",{disabled:1===u,onClick:()=>p(t=>Math.max(t-1,1)),style:z,children:"◀ 이전"}),(0,o.jsxs)("span",{children:[u," / ",Math.ceil(x/5)||1]}),(0,o.jsx)("button",{disabled:l.length<5,onClick:()=>p(t=>t+1),style:z,children:"다음 ▶"})]}),(0,o.jsx)("div",{style:{marginTop:"24px",textAlign:"right"},children:(0,o.jsx)("button",{onClick:r,style:U,children:"닫기"})})]})})}let B={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},O={backgroundColor:"#fff",padding:"24px",borderRadius:"10px",width:"900px",maxHeight:"85vh",overflowY:"auto",boxShadow:"0 4px 10px rgba(0,0,0,0.15)"},R={width:"100%",borderCollapse:"collapse",fontSize:"14px"},L={backgroundColor:"#f1f1f1"},M={padding:"10px",border:"1px solid #ccc",fontWeight:"bold",textAlign:"center"},I={padding:"8px",border:"1px solid #ddd",textAlign:"center",wordBreak:"break-word"},F={display:"flex",justifyContent:"center",gap:"12px",marginTop:"20px"},z={padding:"6px 16px",borderRadius:"4px",border:"1px solid #ccc",backgroundColor:"#f5f5f5",cursor:"pointer"},U={padding:"8px 20px",backgroundColor:"#4f46e5",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"};function UserDetailPageComponent(t){let{user:n}=t,[r,l]=(0,s.useState)({username:"",email:"",phone:"",role:"user",department:"",position:"",company:"",marketing_agree:!1}),[i,u]=(0,s.useState)(""),[p,x]=(0,s.useState)(""),[h,f]=(0,s.useState)(!1),[y,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{n&&n.username&&l({username:n.username||"",email:n.email||"",phone:n.phone||"",role:n.role||"user",company:n.company||"",department:n.department||"",position:n.position||"",marketing_agree:!!n.marketing_agree})},[n]);let handleChange=t=>{let{name:n,value:r,type:o,checked:s}=t.target,i="checkbox"===o?s:r;l(t=>({...t,[n]:i}))},handleSubmit=()=>{let t={};if(Object.entries(r).forEach(r=>{let[o,l]=r;n[o]!==l&&(t[o]={before:n[o],after:l})}),0===Object.keys(t).length){u("변경된 내용이 없습니다.");return}a.ZP.put("/admin/users/".concat(n.id),r).then(async t=>{t.data.success?(u("수정이 완료되었습니다."),f(!1)):u("수정에 실패했습니다.")}).catch(()=>u("서버 오류가 발생했습니다."))},renderField=(t,n,r)=>(0,o.jsxs)("label",{style:W,children:[t,h?(0,o.jsx)("input",{name:n,value:r,onChange:handleChange,style:Z}):(0,o.jsx)("div",{style:N,children:r||"-"})]});return(0,o.jsxs)("div",{style:{padding:"24px",backgroundColor:"#fff",borderRadius:"8px",boxShadow:"0 1px 4px rgba(0,0,0,0.05)"},children:[(0,o.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:"16px"},children:[renderField("이름","username",r.username),renderField("연락처","phone",r.phone),renderField("이메일","email",r.email),(0,o.jsxs)("label",{style:W,children:["비밀번호",(0,o.jsx)("button",{disabled:!h,style:{...Z,cursor:h?"pointer":"not-allowed",textAlign:"center",backgroundColor:h?"#eee":"#f5f5f5"},onClick:async()=>{if(!h)return;let t=window.confirm("이 사용자의 비밀번호를 [1234]로 초기화하시겠습니까?");if(t)try{let t=await a.ZP.put("/admin/users/".concat(n.id,"/reset-password"));t.data.success?u("비밀번호가 [1234]로 초기화되었습니다."):u("초기화에 실패했습니다.")}catch(t){console.error("❌ 비밀번호 초기화 오류:",t),u("비밀번호 초기화 중 오류가 발생했습니다.")}},children:"초기화"})]}),renderField("소속","company",r.company),renderField("부서","department",r.department),renderField("직책","position",r.position),(0,o.jsxs)("label",{style:W,children:[(0,o.jsx)("span",{style:{marginBottom:"4px"},children:"마케팅 수신 동의"}),(0,o.jsx)("div",{style:N,children:r.marketing_agree?"동의":"미동의"})]})]}),(0,o.jsxs)("div",{style:{marginTop:"30px",display:"flex",justifyContent:"center",gap:"16px"},children:[h?(0,o.jsx)("button",{onClick:()=>x("정말 수정하시겠습니까?"),style:H,children:"저장"}):(0,o.jsx)("button",{onClick:()=>f(!0),style:X,children:"수정"}),(0,o.jsx)("button",{onClick:()=>g(!0),style:K,children:"수정이력"})]}),i&&(0,o.jsx)(AlertModal,{message:i,onClose:()=>u("")}),p&&(0,o.jsx)(ConfirmModal,{message:p,onConfirm:()=>{handleSubmit(),x("")},onCancel:()=>x("")}),y&&(0,o.jsx)(HistoryModal,{userId:n.id,onClose:()=>g(!1)})]})}let Z={padding:"8px",borderRadius:"4px",border:"1px solid #ccc",fontSize:"14px"},N={padding:"8px",fontSize:"14px",backgroundColor:"#f9f9f9",borderRadius:"4px",border:"1px solid #eee"},W={display:"flex",flexDirection:"column",fontSize:"14px"},H={padding:"8px 16px",backgroundColor:"#4f46e5",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},X={padding:"8px 16px",backgroundColor:"#ccc",color:"black",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},K={padding:"8px 16px",backgroundColor:"#f3f3f3",border:"1px solid #ccc",borderRadius:"4px",cursor:"pointer",fontSize:"14px"};var q=r(4027);function AdminUserDetailPage(){let t=(0,l.useRouter)(),{id:n}=t.query,{user:r}=(0,s.useContext)(q.St),[u,p]=(0,s.useState)(null),[x,h]=(0,s.useState)(!0);return((0,s.useEffect)(()=>{r&&"admin"!==r.role&&t.replace("/")},[r]),(0,s.useEffect)(()=>{n&&r&&"admin"===r.role&&a.ZP.get("/admin/users/".concat(n)).then(t=>{console.log("✅ res.data.user:",t.data.user),p(t.data.user),h(!1)}).catch(t=>{console.error("❌ 유저 정보 로딩 실패:",t),h(!1)})},[n,r]),r&&"admin"===r.role)?(0,o.jsx)(i.Z,{pageTitle:"\uD83D\uDC64 사용자 상세정보",children:x?null:u?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(UserDetailPageComponent,{user:u}),(0,o.jsx)("div",{style:{marginTop:"40px"},children:(0,o.jsx)(UserTabs,{userId:n})})]}):(0,o.jsx)("p",{children:"사용자를 찾을 수 없습니다."})}):null}},5054:function(t,n,r){"use strict";r.d(n,{w_:function(){return GenIcon}});var o=r(7294),l={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},s=o.createContext&&o.createContext(l),i=["attr","size","title"];function _extends(){return(_extends=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t}).apply(this,arguments)}function ownKeys(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,o)}return r}function _objectSpread(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ownKeys(Object(r),!0).forEach(function(n){var o,l;o=n,l=r[n],(o=function(t){var n=function(t,n){if("object"!=typeof t||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,n||"default");if("object"!=typeof o)return o;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==typeof n?n:n+""}(o))in t?Object.defineProperty(t,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[o]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function GenIcon(t){return n=>o.createElement(IconBase,_extends({attr:_objectSpread({},t.attr)},n),function Tree2Element(t){return t&&t.map((t,n)=>o.createElement(t.tag,_objectSpread({key:n},t.attr),Tree2Element(t.child)))}(t.child))}function IconBase(t){var elem=n=>{var r,{attr:l,size:s,title:a}=t,u=function(t,n){if(null==t)return{};var r,o,l=function(t,n){if(null==t)return{};var r={};for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){if(n.indexOf(o)>=0)continue;r[o]=t[o]}return r}(t,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(o=0;o<s.length;o++)r=s[o],!(n.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(l[r]=t[r])}return l}(t,i),p=s||n.size||"1em";return n.className&&(r=n.className),t.className&&(r=(r?r+" ":"")+t.className),o.createElement("svg",_extends({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,l,u,{className:r,style:_objectSpread(_objectSpread({color:t.color||n.color},n.style),t.style),height:p,width:p,xmlns:"http://www.w3.org/2000/svg"}),a&&o.createElement("title",null,a),t.children)};return void 0!==s?o.createElement(s.Consumer,null,t=>elem(t)):elem(l)}}},function(t){t.O(0,[3365,2644,6342,2251,4403,9774,2888,179],function(){return t(t.s=5271)}),_N_E=t.O()}]);