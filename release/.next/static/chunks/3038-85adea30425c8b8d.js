"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3038],{3038:function(e,t,o){o.d(t,{Z:function(){return CustomCalendar}});var n=o(5893),l=o(7294),r=o(381),d=o.n(r);function ScheduleListModal(e){let{open:t,onClose:o,date:r,events:i}=e;return((0,l.useEffect)(()=>{let handleKeyDown=e=>{"Escape"===e.key&&o()};return t&&document.addEventListener("keydown",handleKeyDown),()=>{document.removeEventListener("keydown",handleKeyDown)}},[t,o]),t)?(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.3)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:2e3},children:(0,n.jsxs)("div",{style:{background:"#fff",padding:"24px",borderRadius:"8px",width:"360px",boxShadow:"0 4px 8px rgba(0,0,0,0.1)",position:"relative"},children:[(0,n.jsx)("button",{onClick:o,style:{position:"absolute",top:12,right:16,background:"none",border:"none",fontSize:28,fontWeight:"bold",color:"#666",cursor:"pointer"},children:"\xd7"}),(0,n.jsxs)("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"16px"},children:[d()(r).format("YYYY년 M월 D일")," 일정"]}),(0,n.jsx)("ul",{style:{maxHeight:"240px",overflowY:"auto",marginBottom:"16px"},children:i.map((e,t)=>(0,n.jsxs)("li",{onClick:()=>{(null==e?void 0:e.type)?window.open("/education/".concat(e.type,"/").concat(e.id),"_blank"):window.open("/education/calendar/".concat(e.id),"_blank")},style:{marginBottom:"8px",fontSize:"14px",cursor:"pointer",color:"#2563eb"},children:["• ",e.title]},t))})]})}):null}var i=o(4451),a=o(3504);function CustomCalendar(e){let{schedules:t,currentMonth:o,setCurrentMonth:r,onSelectSchedule:s,shouldFilterInactive:c=!0,mode:u="user"}=e,[f,p]=(0,l.useState)(null),[x,h]=(0,l.useState)([]),[b,m]=(0,l.useState)(null),handleEdit=e=>{window.location.href="/admin/schedules/".concat(e.id)},handleDelete=async e=>{if(window.confirm("정말 삭제하시겠습니까?"))try{await a.ZP.delete("admin/schedules/".concat(e.id)),alert("삭제되었습니다."),m(null),window.location.reload()}catch(e){console.error("삭제 실패:",e),alert("삭제 실패")}},y=(0,l.useMemo)(()=>{let e=[],t=o.clone().startOf("month").startOf("week"),n=o.clone().endOf("month").endOf("week"),l=t.clone();for(;l.isSameOrBefore(n,"day");){let t=[];for(let e=0;e<7;e++)t.push(l.clone()),l.add(1,"day");e.push(t)}return e},[o]),getColorById=e=>{let t=["#3b82f6","#10b981","#f59e0b","#a855f7","#6366f1","#ec4899","#22d3ee","#ef4444","#8b5cf6","#06b6d4","#eab308","#16a34a","#4ade80","#f43f5e"],o="number"==typeof e?e:e.toString().split("").reduce((e,t)=>e+t.charCodeAt(0),0);return t[o%t.length]},handleMoreClick=(e,t)=>{p(e),h(t)},g=(0,l.useMemo)(()=>{let e=c?t.filter(e=>e.is_active):t;return e.map(e=>({...e,type:e.type||e.category||null,start:d()(e.start),end:d()(e.end)}))},[t,c]),w=(0,l.useMemo)(()=>{let e={};return g.forEach(t=>{let o=d()(t.start).startOf("day"),n=d()(t.end).startOf("day"),l=n.diff(o,"days")+1;for(let n=0;n<l;n++){let l=o.clone().add(n,"days").format("YYYY-MM-DD");e[l]||(e[l]=[]),e[l].push(t)}}),e},[g]);return(0,l.useMemo)(()=>y.map(e=>{let t=[],o=g.filter(t=>t.end.isSameOrAfter(e[0],"day")&&t.start.isSameOrBefore(e[6],"day"));return o.forEach(o=>{let n=o.start,l=o.end,r=-1!==e.findIndex(e=>e.isSame(n,"day"))?e.findIndex(e=>e.isSame(n,"day")):e.findIndex(e=>e.isSameOrAfter(n)),d=-1!==e.findIndex(e=>e.isSame(l,"day"))?e.findIndex(e=>e.isSame(l,"day")):e.findIndex(e=>e.isSameOrBefore(l)),i=!1;for(let e=0;e<t.length;e++){let n=t[e],l=n.some(e=>!(e.end<r||e.start>d));if(!l){n.push({...o,start:r,end:d}),i=!0;break}}i||t.push([{...o,start:r,end:d}])}),t}),[g,o]),(0,n.jsxs)("div",{children:[(0,n.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",tableLayout:"fixed"},children:[(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:["일","월","화","수","목","금","토"].map((e,t)=>(0,n.jsx)("th",{style:{textAlign:"center",padding:"8px",borderBottom:"1px solid #ddd",color:0===t||6===t?"#ef4444":"#111"},children:e},e))})}),(0,n.jsx)("tbody",{children:y.map((e,t)=>(0,n.jsx)("tr",{children:e.map((e,t)=>{let l=e.format("YYYY-MM-DD"),r=e.isSame(d()(),"day"),i=e.month()===o.month(),a=w[l]||[];return(0,n.jsxs)("td",{style:{verticalAlign:"top",padding:"6px",border:"1px solid #eee",height:"120px",backgroundColor:r?"#fff":i?"#fff":"#d1d5db",color:r?"#ef4444":i?0===t||6===t?"#dc2626":"#999":"#c0c0c0",fontWeight:r?"bold":"normal",position:"relative"},children:[(0,n.jsx)("div",{style:{fontSize:"13px",display:"flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",margin:"0 auto",marginBottom:"8px",borderRadius:"50%",backgroundColor:r?"#3b82f6":"transparent",color:r?"#fff":void 0,fontWeight:r?"bold":"normal"},children:e.date()}),a.slice(0,3).map((e,t)=>{let o=getColorById(e.id);return(0,n.jsx)("div",{onClick:()=>s?s(e):m(e),style:{background:o,color:"white",borderRadius:"4px",padding:"2px 4px",fontSize:"12px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",cursor:"pointer",transition:"all 0.2s ease",opacity:1},onMouseEnter:e=>e.currentTarget.style.opacity=.85,onMouseLeave:e=>e.currentTarget.style.opacity=1,children:e.title},t)}),a.length>3&&(0,n.jsxs)("div",{onClick:()=>handleMoreClick(l,a),style:{fontSize:"11px",color:"#2563eb",cursor:"pointer"},children:["+",a.length-3," more"]})]},l)})},"week-".concat(t)))})]}),f&&(0,n.jsx)(ScheduleListModal,{open:!!f,date:f,events:x,onClose:()=>p(null)}),b&&(0,n.jsx)(i.Z,{schedule:b,onClose:()=>m(null),onEdit:()=>handleEdit(b),onDelete:()=>handleDelete(b),mode:u})]})}},4451:function(e,t,o){o.d(t,{Z:function(){return ScheduleDetailModal}});var n=o(5893),l=o(7294),r=o(381),d=o.n(r);function ScheduleDetailModal(e){var t,o;let{schedule:r,onClose:i,onEdit:a,onDelete:s,mode:c="user"}=e;if(!r)return null;console.log("\uD83D\uDCCC ScheduleDetailModal schedule:",r),console.log("\uD83D\uDCCC schedule.type:",null==r?void 0:r.type),(0,l.useEffect)(()=>{let handleEsc=e=>{"Escape"===e.key&&i()};return window.addEventListener("keydown",handleEsc),()=>window.removeEventListener("keydown",handleEsc)},[i]);let formatDateTime=e=>d()(e).format("YYYY.MM.DD A h:mm");return(0,n.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0,0,0,0.4)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},onClick:i,children:(0,n.jsxs)("div",{onClick:e=>e.stopPropagation(),style:{background:"#fff",borderRadius:"12px",padding:"32px",width:"460px",maxWidth:"90%",boxShadow:"0 10px 30px rgba(0,0,0,0.25)",position:"relative"},children:[(0,n.jsx)("button",{onClick:i,style:{position:"absolute",top:"16px",right:"16px",background:"transparent",border:"none",fontSize:"20px",cursor:"pointer",color:"#999"},children:"✕"}),(0,n.jsx)("h2",{style:{marginBottom:"20px",fontSize:"22px",fontWeight:"bold",color:"#111",textAlign:"center"},children:r.title}),(0,n.jsxs)("div",{style:{fontSize:"15px",display:"flex",flexDirection:"column",gap:"12px",marginBottom:"24px"},children:["admin"===c&&(0,n.jsx)(InfoRow,{label:"상품명",value:r.product_title||"-"}),(0,n.jsx)(InfoRow,{label:"장소",value:r.location||"-"}),(0,n.jsx)(InfoRow,{label:"강사",value:r.instructor||"-"}),(0,n.jsx)(InfoRow,{label:"정원",value:null!==(t=r.total_spots)&&void 0!==t?t:"-"}),(0,n.jsx)(InfoRow,{label:"기간",value:"".concat(formatDateTime(r.start)," ~ ").concat(formatDateTime(r.end))}),"admin"===c&&(0,n.jsx)(InfoRow,{label:"가격",value:"number"==typeof(o=r.price)?o.toLocaleString()+"원":"-"}),(0,n.jsx)(InfoRow,{label:"설명",value:r.description||"-"})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:["admin"===c&&s&&(0,n.jsx)("button",{onClick:s,style:{padding:"6px 12px",background:"#ef4444",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},children:"삭제"}),"admin"===c&&a&&(0,n.jsx)("button",{onClick:a,style:{padding:"6px 12px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},children:"수정"}),"user"===c&&(0,n.jsx)("button",{onClick:()=>{(null==r?void 0:r.type)?window.open("/education/".concat(r.type,"/").concat(r.id),"_blank"):window.open("/education/calendar/".concat(r.id),"_blank")},style:{padding:"6px 12px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},children:"상세 보기"})]})]})})}let InfoRow=e=>{let{label:t,value:o}=e;return(0,n.jsxs)("div",{style:{display:"flex"},children:[(0,n.jsx)("div",{style:{width:"80px",fontWeight:"bold",color:"#555"},children:t}),(0,n.jsx)("div",{style:{flex:1,color:"#333"},children:o})]})}}}]);