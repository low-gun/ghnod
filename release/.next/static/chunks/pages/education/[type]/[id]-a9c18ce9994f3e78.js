(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3599],{6664:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/education/[type]/[id]",function(){return i(1032)}])},1032:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return EducationScheduleDetailPage}});var n=i(5893),l=i(1163),o=i(7294),r=i(3504),d=i(4476),s=i(4027);function ProductTabs(e){var t;let{tabs:i}=e,[l,r]=(0,o.useState)((null===(t=i[0])||void 0===t?void 0:t.id)||"");(0,o.useEffect)(()=>{let handler=()=>{let e=window.scrollY;for(let t=i.length-1;t>=0;t--){let n=document.getElementById(i[t].id);if(n&&n.offsetTop-140<=e){r(i[t].id);break}}};return window.addEventListener("scroll",handler),()=>window.removeEventListener("scroll",handler)},[i]),(0,o.useEffect)(()=>{setTimeout(()=>{var e;let t=null===(e=i[0])||void 0===e?void 0:e.id;t&&document.getElementById(t)&&r(t)},50)},[i]);let scrollTo=e=>{let t=document.getElementById(e),i=window.innerWidth<=768?120:80;if(t){let e=t.getBoundingClientRect().top+window.scrollY-i;window.scrollTo({top:e,behavior:"smooth"})}};return(0,n.jsx)("div",{style:{position:"sticky",top:80,backgroundColor:"#fff",zIndex:100,borderBottom:"1px solid #ddd"},children:(0,n.jsx)("div",{style:{display:"flex"},children:i.map(e=>(0,n.jsx)("button",{onClick:()=>scrollTo(e.id),style:{flex:1,padding:"12px 16px",border:"none",borderBottom:l===e.id?"2px solid #0070f3":"2px solid transparent",fontWeight:l===e.id?"bold":"normal",backgroundColor:"transparent",color:l===e.id?"#0070f3":"#666",cursor:"pointer"},children:e.label},e.id))})})}function TabProductDetail(e){let{html:t}=e,i=(0,o.useRef)(null),[l,r]=(0,o.useState)(!1),[d,s]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{i.current&&i.current.scrollHeight>1200&&s(!0)},[t]),(0,n.jsxs)("section",{id:"detail",style:{padding:"40px 0",borderBottom:"1px solid #eee"},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:"bold",marginBottom:20},children:"상품상세"}),(0,n.jsx)("div",{ref:i,className:"detail-box",style:{maxHeight:l?"none":800,overflow:"hidden",transition:"max-height 0.3s ease"},dangerouslySetInnerHTML:{__html:t||"<p>상세 설명이 없습니다.</p>"}}),!l&&d&&(0,n.jsx)("div",{style:{textAlign:"center",marginTop:36},children:(0,n.jsx)("button",{onClick:()=>r(!0),style:{padding:"6px 12px",fontSize:13,backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:4,cursor:"pointer",marginTop:12},children:"더보기 ▼"})})]})}function TabProductReviews(e){let{productId:t}=e,[i,l]=(0,o.useState)([]),[d,s]=(0,o.useState)(!0);return(0,o.useEffect)(()=>{if(!t){s(!1);return}r.ZP.get("/products/".concat(t,"/reviews")).then(e=>{l(e.data.reviews||[])}).catch(e=>{console.error("후기 로딩 실패:",e)}).finally(()=>{s(!1)})},[t]),(0,n.jsxs)("section",{id:"review",style:{padding:"40px 0",borderBottom:"1px solid #eee"},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:"bold",marginBottom:20},children:"상품후기"}),d?(0,n.jsx)(n.Fragment,{}):0===i.length?(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:300,backgroundColor:"#fafafa",color:"#888",fontSize:14,borderRadius:8,textAlign:"center"},children:[(0,n.jsx)("p",{style:{marginBottom:8},children:"등록된 후기가 없습니다."}),(0,n.jsx)("p",{children:"첫 후기를 남겨보세요!"})]}):(0,n.jsx)("ul",{style:{display:"flex",flexDirection:"column",gap:24},children:i.map(e=>(0,n.jsxs)("li",{style:{border:"1px solid #ddd",padding:16,borderRadius:8},children:[(0,n.jsx)("strong",{children:e.username})," \xa0⭐ ",e.rating,"/5",(0,n.jsx)("p",{style:{marginTop:8},children:e.comment}),(0,n.jsx)("p",{style:{fontSize:12,color:"#aaa",marginTop:4},children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]})}function TabProductInquiry(){return(0,n.jsxs)("section",{id:"inquiry",style:{padding:"40px 0",borderBottom:"1px solid #eee"},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:"bold",marginBottom:20},children:"상품문의"}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:300,backgroundColor:"#fafafa",color:"#888",fontSize:14,borderRadius:8,textAlign:"center"},children:[(0,n.jsx)("p",{style:{marginBottom:8},children:"상품 문의 기능은 준비 중입니다."}),(0,n.jsx)("p",{children:"빠른 시일 내에 오픈될 예정입니다."})]})]})}function TabRefundPolicy(){return(0,n.jsxs)("section",{id:"refund",style:{padding:"40px 0",borderBottom:"1px solid #eee",marginBottom:300},children:[(0,n.jsx)("h2",{style:{fontSize:20,fontWeight:"bold",marginBottom:20},children:"환불안내"}),(0,n.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:300,backgroundColor:"#fafafa",color:"#888",fontSize:14,borderRadius:8,textAlign:"center"},children:[(0,n.jsx)("p",{children:"결제 후 7일 이내에는 100% 환불이 가능합니다."}),(0,n.jsx)("p",{children:"교육 시작 후에는 환불이 불가합니다."}),(0,n.jsx)("p",{children:"자세한 사항은 고객센터로 문의 주세요."})]})]})}var a=i(8439);function EducationScheduleDetailPage(){var e,t,i;let c=(0,l.useRouter)(),{cartItems:u,setCartItems:f}=(0,d.iQ)(),{user:h}=(0,s.SE)(),{type:p,id:x}=c.query,[g,m]=(0,o.useState)(null),[y,b]=(0,o.useState)(1),[j,v]=(0,o.useState)(!0),handleBuyNow=async()=>{if(!h)return alert("로그인 후 결제하실 수 있습니다."),c.push("/login");if(!g)return alert("일정 정보를 불러오지 못했습니다.");try{c.push({pathname:"/checkout",query:{buyNow:encodeURIComponent(JSON.stringify({schedule_id:g.id,quantity:y,unit_price:Number(g.price),discount_price:0}))}})}catch(e){console.error("❌ 바로구매 처리 중 오류:",e),alert("바로구매 중 오류가 발생했습니다.")}};if((0,o.useEffect)(()=>{x&&r.ZP.get("/education/schedules/".concat(x)).then(e=>{console.log("\uD83D\uDD25 받은 일정:",e.data.schedule),e.data.success&&m(e.data.schedule)}).catch(()=>alert("일정 정보를 불러오지 못했습니다.")).finally(()=>v(!1))},[x]),j)return(0,n.jsx)("p",{style:{padding:40},children:"불러오는 중..."});if(!g)return(0,n.jsx)("p",{style:{padding:40},children:"일정 정보를 찾을 수 없습니다."});let w=Number(null!==(t=null!==(e=g.price)&&void 0!==e?e:g.product_price)&&void 0!==t?t:0);return(0,n.jsxs)("div",{style:{maxWidth:1200,margin:"0 auto",padding:40,fontSize:16,color:"#333"},children:[(0,n.jsxs)("div",{style:{fontSize:13,color:"#999",marginBottom:24},children:[(0,n.jsx)("span",{onClick:()=>c.push("/education"),style:{cursor:"pointer",marginRight:6},children:"교육"}),">",(0,n.jsx)("span",{onClick:()=>c.push("/education/".concat(p)),style:{cursor:"pointer",marginLeft:6},children:p})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:40,alignItems:"flex-start"},children:[(0,n.jsx)("div",{style:{flex:1},children:(0,n.jsx)("div",{style:{width:"100%",aspectRatio:"4 / 3",border:"1px solid #ccc",borderRadius:8,backgroundColor:"#f9f9f9",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center"},children:g.image_url?(0,n.jsx)("img",{src:g.image_url,alt:g.title,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}):g.product_image?(0,n.jsx)("img",{src:g.product_image,alt:g.title,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}):(0,n.jsx)("span",{style:{color:"#888"},children:"이미지가 없습니다"})})}),(0,n.jsxs)("div",{style:{flex:1},children:[(0,n.jsx)("h1",{style:{fontSize:28,marginBottom:10},children:g.title}),(0,n.jsxs)("p",{style:{fontSize:18,fontWeight:"bold",marginBottom:16},children:[Number(g.price).toLocaleString(),"원"]}),(0,n.jsx)("div",{style:{paddingTop:12},children:[{label:"교육기간",value:(()=>{let e=new Date(g.start_date),t=new Date(g.end_date),i=e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate();return i?e.toLocaleDateString():"".concat(e.toLocaleDateString()," ~ ").concat(t.toLocaleDateString())})()},{label:"장소",value:g.location||"-"},{label:"강사",value:g.instructor||"-"},{label:"정원",value:"".concat(null!==(i=g.total_spots)&&void 0!==i?i:"-","명")}].map((e,t)=>(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"16px 0",borderBottom:"1px solid #eee",fontSize:15},children:[(0,n.jsx)("span",{style:{color:"#666"},children:e.label}),(0,n.jsx)("span",{children:e.value})]},t))}),(0,n.jsx)("div",{style:{display:"flex",justifyContent:"space-between",padding:"16px 0",borderBottom:"1px solid #eee",fontSize:15,whiteSpace:"pre-line"},children:(0,n.jsx)("span",{style:{textAlign:"right",maxWidth:"70%"},children:g.description||"-"})}),(0,n.jsxs)("div",{style:{marginTop:30},children:[(0,n.jsxs)("div",{style:{marginBottom:28,padding:"10px",backgroundColor:"#f7f9fc",borderRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)("span",{style:{fontWeight:500,color:"#333"},children:"수량"}),(0,n.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",border:"1px solid #ccc",borderRadius:6,overflow:"hidden"},children:[(0,n.jsx)("button",{onClick:()=>b(e=>Math.max(1,e-1)),style:{width:32,height:36,border:"none",background:"#fff",cursor:"pointer",fontSize:18},children:"–"}),(0,n.jsx)("div",{style:{width:50,textAlign:"center",fontSize:15,lineHeight:"36px",background:"#fff"},children:y}),(0,n.jsx)("button",{onClick:()=>b(e=>e+1),style:{width:32,height:36,border:"none",background:"#fff",cursor:"pointer",fontSize:18},children:"+"})]})]}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:16,fontSize:16},children:[(0,n.jsxs)("span",{style:{color:"#333"},children:["총 ",y,"명"]}),(0,n.jsxs)("span",{style:{fontWeight:"bold"},children:[Number(w*y).toLocaleString(),"원"]})]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:12,marginTop:20},children:[(0,n.jsx)("button",{onClick:async()=>{try{let e={schedule_id:g.id,quantity:y,unit_price:w,type:"buyNow"};console.log("\uD83D\uDCE6 담기 요청 값:",e);let t=localStorage.getItem("guest_token"),i=await r.ZP.post("/cart/items",e,{headers:{"x-guest-token":t||""}});if(i.data.success){alert("\uD83D\uDED2 장바구니에 담았습니다!");let e={id:Date.now(),schedule_id:g.id,schedule_title:g.title,image_url:g.image_url||g.product_image||null,quantity:1,unit_price:Number(g.price),discount_price:null,subtotal:Number(g.price)};f(t=>[...t,e])}else alert("❌ 장바구니 담기에 실패했습니다.")}catch(e){console.error("장바구니 담기 오류:",e),alert("오류가 발생했습니다. 다시 시도해주세요.")}},style:{flex:1,minWidth:"40%",padding:"10px 16px",border:"1px solid #0070f3",backgroundColor:"#fff",color:"#0070f3",borderRadius:6,fontWeight:500,cursor:"pointer"},children:"장바구니"}),(0,n.jsx)("button",{onClick:handleBuyNow,style:{flex:1,minWidth:"40%",padding:"10px 16px",backgroundColor:"#0070f3",color:"#fff",border:"none",borderRadius:6,fontWeight:500,cursor:"pointer"},children:"바로 구매"})]})]})]}),(0,n.jsx)(ProductTabs,{tabs:[{id:"detail",label:"상품상세"},{id:"review",label:"상품후기"},{id:"inquiry",label:"상품문의"},{id:"refund",label:"환불안내"}]}),(0,n.jsx)("div",{id:"detail",children:(0,n.jsx)(TabProductDetail,{html:g.detail})}),(0,n.jsx)("div",{id:"review",children:(0,n.jsx)(TabProductReviews,{})}),(0,n.jsx)("div",{id:"inquiry",children:(0,n.jsx)(TabProductInquiry,{})}),(0,n.jsx)("div",{id:"refund",children:(0,n.jsx)(TabRefundPolicy,{})}),(0,n.jsx)(a.Z,{})]})}}},function(e){e.O(0,[9774,2888,179],function(){return e(e.s=6664)}),_N_E=e.O()}]);