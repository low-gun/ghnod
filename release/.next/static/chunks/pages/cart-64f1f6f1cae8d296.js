(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9190],{8086:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/cart",function(){return a(42)}])},7081:function(e,t,a){"use strict";a.d(t,{Z:function(){return SearchFilter}});var n=a(5893),l=a(1988);function SearchFilter(e){let{searchType:t,setSearchType:a,searchQuery:i,setSearchQuery:r,searchOptions:s=[],onSearchUpdate:c,startDate:d,endDate:o,setStartDate:p,setEndDate:u}=e,h=s.find(e=>e.value===t),x={padding:"8px",fontSize:"14px",borderRadius:"6px",border:"1px solid #ccc"},handleQueryChange=e=>{let a=e.target.value;r(a),c(t,a)};return(0,n.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center",flexWrap:"wrap"},children:[(0,n.jsx)("select",{value:t,onChange:e=>{let t=e.target.value;a(t),r(""),c(t,"")},style:{...x,width:"140px"},children:s.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))}),(null==h?void 0:h.type)==="date"?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.ZP,{selected:d,onChange:e=>p(e),placeholderText:"시작 날짜",dateFormat:"yyyy-MM-dd",customInput:(0,n.jsx)("input",{style:{...x,width:"140px",height:"38px"}})}),(0,n.jsx)(l.ZP,{selected:o,onChange:e=>u(e),placeholderText:"종료 날짜",dateFormat:"yyyy-MM-dd",customInput:(0,n.jsx)("input",{style:{...x,width:"140px",height:"38px"}})})]}):(null==h?void 0:h.type)==="select"&&Array.isArray(h.options)?(0,n.jsxs)("select",{value:i,onChange:handleQueryChange,style:{...x,width:"180px"},children:[(0,n.jsx)("option",{value:"",children:"전체"}),h.options.map(e=>(0,n.jsx)("option",{value:e.value,children:e.label},e.value))]}):(0,n.jsx)("input",{type:"text",placeholder:"검색어 입력",value:i,onChange:handleQueryChange,style:{...x,width:"240px"}})]})}a(5890)},42:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return CartPage}});var n=a(5893),l=a(7294),i=a(1163),r=a(3504),s=a(7081),c=a(8097),d=a(4476),o=a(5427);function CartPage(){let e=(0,i.useRouter)(),{cartItems:t,cartReady:a,refreshCart:g,setCartItems:m}=(0,d.iQ)(),[j,C]=(0,l.useState)("title"),[v,S]=(0,l.useState)(""),[w,b]=(0,l.useState)([]),[k,_]=(0,l.useState)(0),[P,I]=(0,l.useState)(0),[Q,T]=(0,l.useState)([]),[Z,W]=(0,l.useState)(0),[E,U]=(0,l.useState)(null);(0,l.useEffect)(()=>{let fetchUserInfo=async()=>{try{let e=await r.ZP.get("/user");W(e.data.point_balance||0),T(e.data.coupons||[])}catch(e){console.error("유저 정보 불러오기 실패",e)}};fetchUserInfo()},[]),(0,l.useEffect)(()=>{if(!e.isReady)return;let{searchType:t="title",searchValue:a=""}=e.query;C(t),S(a)},[e.isReady,e.query]),(0,l.useEffect)(()=>{a&&0!==t.length&&b(t.map(e=>e.id))},[a,t]);let handleSearchUpdate=(e,t)=>{C(e),S(t),updateQueryParams({searchType:e,searchValue:t})},D=t.length>0&&t.every(e=>w.includes(e.id)),handleCheckAll=e=>b(e?t.map(e=>e.id):[]),handleItemCheck=(e,t)=>{b(a=>t?[...a,e]:a.filter(t=>t!==e))},handleQuantityChange=async(e,t)=>{let a=e.quantity+t;if(!(a<1))try{var n;await r.ZP.put("/cart/items/".concat(e.id),{quantity:a,unit_price:e.unit_price,discount_price:null!==(n=e.discount_price)&&void 0!==n?n:0}),g()}catch(e){alert("수량 변경 실패")}},handleDeleteSelected=async()=>{if(0===w.length)return alert("삭제할 항목이 없습니다.");if(confirm("선택된 ".concat(w.length,"개를 삭제하시겠습니까?")))try{await Promise.all(w.map(e=>r.ZP.delete("/cart/items/".concat(e)))),g()}catch(e){alert("삭제 실패")}},handleDeleteSingle=async e=>{if(confirm("이 항목을 삭제하시겠습니까?"))try{await r.ZP.delete("/cart/items/".concat(e)),g()}catch(e){alert("삭제 실패")}};return(0,n.jsxs)("div",{style:{padding:"20px"},children:[(0,n.jsx)("h2",{style:{fontSize:"1.2rem",marginBottom:"16px"},children:"장바구니"}),(0,n.jsxs)("div",{style:p,children:[(0,n.jsxs)("div",{style:u,children:[(0,n.jsx)(s.Z,{searchType:j,setSearchType:e=>handleSearchUpdate(e,v),searchQuery:v,setSearchQuery:e=>handleSearchUpdate(j,e),searchOptions:[{value:"title",label:"교육명",type:"text"}],onSearchUpdate:handleSearchUpdate}),(0,n.jsx)("button",{onClick:()=>{C("title"),S(""),updateQueryParams({searchType:"title",searchValue:""})},style:buttonStyle("#ccc","#333"),children:"초기화"})]}),(0,n.jsxs)("div",{style:h,children:[(0,n.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:6},children:[(0,n.jsx)("input",{type:"checkbox",checked:D,onChange:e=>handleCheckAll(e.target.checked)}),(0,n.jsx)("span",{style:{fontSize:"14px"},children:"전체선택"})]}),w.length>0&&(0,n.jsx)("button",{onClick:handleDeleteSelected,style:{backgroundColor:"#ef4444",color:"#fff",border:"none",borderRadius:"6px",padding:"6px 12px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",marginLeft:"8px"},children:"삭제"})]})]}),a?0===t.length?(0,n.jsx)("p",{style:{textAlign:"center",width:"100%",marginTop:40},children:"장바구니가 비어있습니다."}):(0,n.jsxs)("div",{style:x,children:[(0,n.jsx)("div",{style:y,children:t.map(e=>(0,n.jsx)(o.Z,{item:e,selected:w.includes(e.id),onCheck:handleItemCheck,onDelete:handleDeleteSingle,onQuantityChange:handleQuantityChange},e.id))}),(0,n.jsx)("div",{style:f,children:(0,n.jsx)(c.Z,{items:t.filter(e=>w.includes(e.id)),couponDiscount:k,pointUsed:P,onCouponChange:e=>{_(e.amount||0),U(e)},onPointChange:I,couponList:Q,maxPoint:Z,onCheckout:()=>e.push({pathname:"/checkout",query:{itemIds:w.join(","),couponId:null==E?void 0:E.id,point:P}})})})]}):null]})}let buttonStyle=(e,t)=>({padding:"8px 14px",backgroundColor:e,color:t,border:"none",borderRadius:"6px",fontWeight:"bold",cursor:"pointer"}),p={display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"16px",gap:"10px",rowGap:"12px"},u={display:"flex",gap:10,flex:1,minWidth:0,flexWrap:"wrap"},h={display:"flex",gap:"8px",flexWrap:"wrap",flexShrink:0,alignItems:"center"},x={display:"flex",flexWrap:"wrap",alignItems:"flex-start",gap:"24px",marginTop:"20px"},y={flex:"1 1 auto",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px"},f={flex:"0 0 320px",maxWidth:"100%",width:"320px",alignSelf:"flex-start",position:"sticky",top:100}}},function(e){e.O(0,[2644,6342,4403,1238,9774,2888,179],function(){return e(e.s=8086)}),_N_E=e.O()}]);